{"version":3,"sources":["data/helpers.js","store/workspace.js","services/firebase/index.js","services/firebase/context.js","components/layout/sign-in.js","helpers/form.js","components/welcome/index.js","helpers/router.js","components/layout/index.js","components/seo.js","components/controls/code/index.js","components/controls/data-picker/index.js","components/controls/encoding-field/index.js","components/controls/repeat/index.js","components/controls/layer/index.js","components/controls/data/index.js","components/workspace/editor/control-group/schema.js","components/workspace/editor/control-group/index.js","components/workspace/editor/chart/index.js","components/workspace/editor/index.js","components/workspace/index.js","pages/workspace.js","components/showcase/index.js","pages/showcase.js","pages/404.js","pages/show.js","App.js","serviceWorker.js","index.js"],"names":["_SCHEMA","SCHEMA","OPERANDS","constructJsonSpec","value","_","isArray","map","Object","$ref","rest","objectWithoutProperties","ref","includes","path","replace","get","objectSpread","res","mapValues","findSchema","definitions","findEnum","schema","arguments","length","undefined","allEnum","enum","push","apply","toConsumableArray","anyOf","forEach","s","console","log","DATA_SOURCE","Url","Values","WorkspaceStore","folders","id","name","children","user","localStorage","getItem","tabs","activeTab","settings","switchTab","tabId","type","payload","setUser","_ref","setItem","addTab","uuidv4","spec","DEFAULT_SPEC","removeTab","changeSpec","set","setTabProp","prop","setView","view","SET_DATA_KEYS","setDataKeys","dispatch","fetch","then","json","keys","catch","error","setData","setFolders","WorkspaceReducer","state","action","switchTabReducer","_ref2","concat","data","url","values","dataKeys","addTabReducer","tabPosition","findIndex","filter","tab","removeTabReducer","merge","changeSpecReducer","setViewReducer","finalize","defineProperty","setDataReducer","setDataKeysReducer","setUserReducer","setTabPropReducer","setFoldersReducer","thunk","_ref3","_ref4","slicedToArray","store","next","useWorkspaceStore","_withMiddlewares","_len","middlewares","Array","_key","_ref5","_ref6","chain","middleware","compositeDispatch","_len2","funcs","_key2","arg","reduce","a","b","compose","withMiddlewares","useReducer","_withMiddlewares2","find","first","getActiveTab","getDataKeys","actionCreators","val","bindActionCreators","WorkspaceContext","createContext","useWorkspaceContext","useContext","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","initialize","firebase","apps","initializeApp","createBase","collection","firestore","add","saveBase","doc","getBase","saveOrCreateBase","queryBase","userId","where","db","key","snapshotBase","fn","onSnapshot","snapshot","saveNewChart","user_id","saveEditedChart","uuid","getChartCollection","d","getUserById","Error","getUserByName","users","createUser","saveCollection","folderName","createFolder","saveWorkspace","workspace","FirebaseContext","FirebaseProvider","useEffect","react_default","createElement","Provider","useFirebaseContext","useFirebaseSnapshot","initialValue","_useState","useState","_useState2","setValue","SignInForm","setName","es_input","onChange","e","target","SignIn","_useWorkspaceContext","_useWorkspaceContext$","_useFirebaseContext","showModal","toggleModal","_useState3","_useState4","_useState5","_useState6","setError","signIn","useCallback","message","signUp","modal","title","visible","okText","onOk","onCancel","cancelText","sign_in_SignInForm","formItemLayout","labelCol","xs","span","sm","wrapperCol","TabPane","Tabs","WelcomeChart","chartSelected","charts","setCharts","result","Fragment","className","skeleton","active","chart","style","width","VegaLite_default","height","overflow","background","display","justifyContent","alignItems","renderer","description","es_button","size","onClick","onChartSelected","WelcomeCollection","defaultCollection","setCollection","desc","es_form","Item","label","v","TextArea","Welcome","toggleVisibility","history","__RouterContext","footer","overflowY","es_tabs","defaultActiveKey","welcome_WelcomeChart","welcome_WelcomeCollection","react_router_dom","to","Header","ALayout","Content","Footer","MENU_ITEMS","Layout","location","_useWorkspaceContext$2","layout","welcome","sign_in","es_menu","theme","mode","selectedKeys","pathname","lineHeight","capitalize","item","textAlign","ASEO","Code","memo","_ref3$format","format","_ref3$height","lib_default","language","options","selectOnLineNumbers","InputGroup","Input","Group","NameModal","show","toggleShow","_useWorkspaceContext2","_useState7","_useState8","_useState9","_useState10","folder","setFolder","saveChart","cObj","c","each","f","es_select","Option","DataPicker","onDataChanged","_useState11","_useState12","compact","icon","data_picker_NameModal","Repeat","_ref$value","_ref$value$row","row","_ref$value$column","column","_ref$config","_ref$config$options","_ref$onChange","onRowChange","onColumnChange","href","placeholder","defaultValue","option","RepeatSchema","generator","Component","$schema","SCHEMES","DropdownMenu","_ref$label","_ref$options","onMenuItemClicked","onItemClicked","schemeMenu","maxHeight","boxShadow","dropdown","Button","overlay","LayerEncoding","_ref2$layerIndex","layerIndex","_ref2$encoding","encoding","_ref2$value","types","aggregates","rootPath","field","aggregate","scale","scheme","axis","addonBefore","addonAfter","orient","y","x","legend","react_color_lib","color","hex","backgroundColor","LayerMark","_ref3$layerIndex","isObject","LayerItem","_ref4$value","_ref4$value$mark","mark","_ref4$value$encoding","_ref4$index","index","encodings","menu","properties","disabled","startCase","overlayStyle","Layer","_ref5$config","_useWorkspaceContext3","marks","activeLayer","setActiveLayer","addLayer","newLayer","last","layer","isEmpty","response","text","JSON","parse","csvjson","toObject","collapse","accordion","bordered","activeKey","String","Panel","header","divider","orientation","LayerSchema","URLData","defaultUrl","setUrl","tryUrl","fetchData","reason","Search","onSearch","enterButton","code","ValuesData","setFormat","_unused","stringify","Data","setType","es_radio","data_URLData","data_ValuesData","Schema","ControlGroup","Select","_ref5$store","schemaItem","ExportTab","EXPORT_OPTIONS","chart_ExportTab","class","src","border","Export","Chart","onNewView","marginLeft","boxSizing","esm","tooltip","Handler","call","chart_Export","Editor","shouldFetch","data_picker","es_row","col","control_group","editor_chart","SubMenu","Menu","Sider","WorkspaceFolder","onSelectItem","WorkspaceTabs","_useWorkspaceContext4","_useWorkspaceContext5","child","i","onSwitchTab","onAddTab","onRemoveTab","onEdit","editor","Workspace","_useWorkspaceContext6","padding","workspace_Content","minHeight","WorkspacePage","props","components_layout","components_workspace","SAMPLES","emojiSpec","category","ganttSpec","histoSpec","waterSpec","scatrSpec","ShowcaseModal","withRouter","onOK","maxWidth","ShowcaseItem","ShowcaseGrid","items","showcase_ShowcaseItem","Showcase","objectDestructuringEmpty","activeCategory","setCategory","defaultSelectedKeys","uniqBy","showcase_ShowcaseGrid","ShowcasePage","showcase","NotFoundPage","ShowPage","match","params","setSpec","App","context_FirebaseProvider","store_workspace","react_router","exact","render","component","Boolean","window","hostname","ReactDOM","src_App","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.904b670c.chunk.js","sourcesContent":["import _ from 'lodash'\r\nimport SCHEMA from './schema.json'\r\nimport DEFAULT_SPEC from './empty.json'\r\nconst _SCHEMA = SCHEMA\r\n\r\nconst OPERANDS = [\r\n\t'#/definitions/SelectionNot',\r\n\t'#/definitions/SelectionOperand',\r\n\t'#/definitions/LogicalOperand<Predicate>',\r\n\t'#/definitions/LogicalNot<Predicate>'\r\n]\r\n\r\nexport function getDefaultSpec() {\r\n\treturn {...DEFAULT_SPEC}\r\n}\r\n\r\nexport function getDefaultLayer() {\r\n\treturn {...DEFAULT_SPEC}.spec.layer[0];\r\n}\r\n\r\nexport function splitPath(path) {\r\n\treturn _.split(path, '.')\r\n}\r\n\r\nexport function findJsonSchema(value) {\r\n\tif(value.anyOf) {\r\n\t\treturn _.map(value.anyOf, ({$ref})=>{\r\n\t\t\tlet path = _.replace($ref, /#\\//g, '')\r\n\t\t\tpath = _.replace(path, /\\//, '.')\r\n\t\t\treturn _.get(_SCHEMA, path)\r\n\t\t})\r\n\t}\r\n\treturn []\r\n}\r\n\r\nexport function constructJsonSpec(value) {\r\n\tif(_.isArray(value)) {\r\n\t\treturn _.map(value, constructJsonSpec)\r\n\t} else if(value instanceof Object) {\r\n\t\tconst { $ref, ...rest } = value\r\n\t\tlet ref = {}\r\n\t\tif($ref && !_.includes(OPERANDS, $ref)) {\r\n\t\t\tlet path = _.replace($ref, /#\\//g, '')\r\n\t\t\tpath = _.replace(path, /\\//, '.')\r\n\t\t\tref = _.get(_SCHEMA, path)\r\n\t\t\tif(ref.$ref && !_.includes(OPERANDS, $ref)) {\r\n\t\t\t\tref = {\r\n\t\t\t\t\t$ref: ref.$ref,\r\n\t\t\t\t\t...ref,\r\n\t\t\t\t\t...constructJsonSpec(ref)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet res = {\r\n\t\t\t...ref,\r\n\t\t\t...rest\r\n\t\t} \r\n\t\treturn _.mapValues(res, constructJsonSpec)\r\n\t} else {\r\n\t\treturn value\r\n\t}\r\n}\r\n\r\nexport function findSchema(path) {\r\n\tlet schema = _.get(_SCHEMA.definitions, path);\r\n\treturn constructJsonSpec(schema)\r\n}\r\n\r\nexport function findEnum(schema = {}) {\r\n\tlet allEnum = []\r\n\tif(schema.enum) {\r\n\t\tallEnum.push(...schema.enum)\r\n\t} else if(schema.anyOf) {\r\n\t\tschema.anyOf.forEach((s)=>allEnum.push(...findEnum(s)))\r\n\t}\r\n\treturn allEnum\r\n}\r\n\r\nconsole.log('Encoding',findSchema('Encoding'))","import {\r\n\tuseReducer, useContext, createContext\r\n} from \"react\";\r\n// import barSpec from '../data/samples/bar.json'\r\nimport _ from 'lodash'\r\nimport uuidv4 from 'uuid/v4'\r\nimport { getDefaultSpec } from \"../data/helpers\";\r\n\r\nexport const DATA_SOURCE = {\r\n\tUrl: 'url',\r\n\tValues: 'values'\r\n}\r\n\r\n\r\nconst WORKSPACE_FOLDERS = [\r\n\t{\r\n\t\tid: '1',\r\n\t\tname: 'Project 1',\r\n\t\tchildren: [\r\n\t\t\t{\r\n\t\t\t\tid: '1.1',\r\n\t\t\t\tname: 'Chart 1'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: '1.2',\r\n\t\t\t\tname: 'Chart 2'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: '1.3',\r\n\t\t\t\tname: 'Chart 3'\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\tid: '2',\r\n\t\tname: 'Project 2',\r\n\t\tchildren: [\r\n\t\t\t{\r\n\t\t\t\tid: '2.1',\r\n\t\t\t\tname: 'Chart 2.1'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: '2.2',\r\n\t\t\t\tname: 'Chart 2.2'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: '2.3',\r\n\t\t\t\tname: 'Chart 2.3'\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n]\r\n\r\nconst WorkspaceStore = {\r\n\tfolders: WORKSPACE_FOLDERS,\r\n\tuser: {\r\n\t\tname: '',\r\n\t\tid: localStorage.getItem('user_id')\r\n\t},\r\n\ttabs: [\r\n\t\t// {\r\n\t\t// \tid: '1',\r\n\t\t// \tname: 'New Tab',\r\n\t\t// \tspec: getDefaultSpec(),\r\n\t\t// \tdataKeys: _.keys(getDefaultSpec().data.values[0]),\r\n\t\t// \tdata: {\r\n\t\t// \t\ttype: DATA_SOURCE.Values,\r\n\t\t// \t\tvalue: getDefaultSpec().data.values\r\n\t\t// \t}\r\n\t\t// }\r\n\t],\r\n\tactiveTab: '1',\r\n\tsettings: {\r\n\r\n\t}\r\n}\r\n\r\nconst SWITCH_TAB = '@workspace/SWITCH_TAB'\r\nexport const switchTab = (tabId) => {\r\n\treturn {\r\n\t\ttype: SWITCH_TAB,\r\n\t\tpayload: tabId\r\n\t}\r\n}\r\nconst switchTabReducer = (state, tabId) => {\r\n\treturn {\r\n\t\t...state,\r\n\t\tactiveTab: tabId\r\n\t}\r\n}\r\n\r\n\r\nconst SET_USER = '@workspace/SET_USER'\r\nexport const setUser = ({name, id}) => {\r\n\tlocalStorage.setItem('user_id', id)\r\n\treturn {\r\n\t\ttype: SET_USER,\r\n\t\tpayload: {\r\n\t\t\tname,\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n}\r\nconst setUserReducer = (state, user) => {\r\n\tif(!user.id) return state\r\n\treturn {\r\n\t\t...state,\r\n\t\tuser: user\r\n\t}\r\n}\r\n\r\nconst ADD_TAB = '@workspace/ADD_TAB'\r\nconst addTab = (tabId = uuidv4(), spec = getDefaultSpec(), name = 'New Tab') => {\r\n\treturn {\r\n\t\ttype: ADD_TAB,\r\n\t\tpayload: {\r\n\t\t\ttabId,\r\n\t\t\tspec,\r\n\t\t\tname\r\n\t\t}\r\n\t}\r\n}\r\nexport const addTabReducer = (state, {tabId, spec, name}) => {\r\n\tlet { tabs } = state\r\n\tlet activeTab = tabId\r\n\tif(!_.includes(_.map(tabs, 'id'), tabId)) {\r\n\t\ttabs = [\r\n\t\t\t...tabs, \r\n\t\t\t{\r\n\t\t\t\tid: tabId,\r\n\t\t\t\tname,\r\n\t\t\t\tspec,\r\n\t\t\t\tdata: {\r\n\t\t\t\t\ttype: (spec.data && spec.data.url && DATA_SOURCE.Url) || DATA_SOURCE.Values,\r\n\t\t\t\t\tvalue: (spec.data && (spec.data.url || spec.data.values)) || ''\r\n\t\t\t\t},\r\n\t\t\t\tdataKeys: (spec.data && spec.data.values && _.keys(spec.data.values[0])) || []\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn {\r\n\t\t...state,\r\n\t\ttabs,\r\n\t\tactiveTab,\r\n\t\tview: undefined\r\n\t}\r\n}\r\n\r\nconst REMOVE_TAB = `@workspace/REMOVE_TAB`\r\nconst removeTab = (tabId) => {\r\n\treturn {\r\n\t\ttype: REMOVE_TAB,\r\n\t\tpayload: tabId\r\n\t}\r\n}\r\nexport const removeTabReducer = (state, tabId) => {\r\n\tlet tabPosition = _.findIndex(state.tabs, {id:tabId})\r\n\treturn {\r\n\t\t...state,\r\n\t\tactiveTab: (state.tabs.length - 1) ? state.tabs[tabPosition-1].id : '1',\r\n\t\ttabs: _.filter(state.tabs, (tab) => tab.id !== tabId)\r\n\t}\r\n}\r\n\r\nconst CHANGE_SPEC = '@workspace/CHANGE_SPEC'\r\nconst changeSpec = (path, value) => {\r\n\treturn {\r\n\t\ttype: CHANGE_SPEC,\r\n\t\tpayload: path ? _.set({}, path, value) : value\r\n\t}\r\n}\r\nconst changeSpecReducer = (state, payload) => {\r\n\treturn {\r\n\t\t...state,\r\n\t\ttabs: _.map(state.tabs, (tab)=> {\r\n\t\t\tif(tab.id !== state.activeTab) return tab\r\n\t\t\treturn {\r\n\t\t\t\t...tab,\r\n\t\t\t\tspec: _.merge({}, tab.spec, payload)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\n\r\nconst SET_TAB_PROP = '@workspace/SET_TAB_PROP'\r\nconst setTabProp = (prop) => {\r\n\treturn {\r\n\t\ttype: SET_TAB_PROP,\r\n\t\tpayload: prop\r\n\t}\r\n}\r\nconst setTabPropReducer = (state, prop) => {\r\n\treturn {\r\n\t\t...state,\r\n\t\ttabs: _.map(state.tabs, (tab)=> {\r\n\t\t\tif(tab.id !== state.activeTab) return tab\r\n\t\t\treturn {\r\n\t\t\t\t...tab,\r\n\t\t\t\t...prop\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\nconst SET_VIEW = '@workspace/SET_VIEW'\r\nconst setView = (view) => ({\r\n\ttype: SET_VIEW,\r\n\tpayload: view\r\n})\r\nconst setViewReducer = (state, payload) => {\r\n\tif(!state.view) {\r\n\t\treturn {\r\n\t\t\t...state,\r\n\t\t\tview: payload\r\n\t\t}\r\n\t}\r\n\treturn state\r\n}\r\n\r\n\r\nconst SET_DATA_KEYS = '@workspace/SET_DATA_KEYS'\r\nconst setDataKeys = (value) => {\r\n\tif (_.isArray(value)) {\r\n\t\treturn {\r\n\t\t\ttype: SET_DATA_KEYS,\r\n\t\t\tpayload: value\r\n\t\t}\r\n\t}\r\n\treturn (dispatch) => {\r\n\t\tfetch(value)\r\n\t\t.then((res)=>{\r\n\t\t\tconsole.log(res)\r\n\t\t\treturn res.json()\r\n\t\t})\r\n\t\t.then((json)=>{\r\n\t\t\tconsole.log(json)\r\n\t\t\treturn _.keys(json[0])\r\n\t\t})\r\n\t\t.then((keys)=>{\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: SET_DATA_KEYS,\r\n\t\t\t\tpayload: keys\r\n\t\t\t})\r\n\t\t})\r\n\t\t.catch(console.error)\r\n\t}\r\n}\r\nconst setDataKeysReducer = (state, keys) => {\r\n\treturn {\r\n\t\t...state,\r\n\t\ttabs: _.map(state.tabs, (tab)=> {\r\n\t\t\tif(tab.id !== state.activeTab) return tab\r\n\t\t\treturn {\r\n\t\t\t\t...tab,\r\n\t\t\t\tdataKeys: keys\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\nconst SET_DATA = '@workspace/SET_DATA'\r\nconst setData = (type, value) => {\r\n\treturn (dispatch) => {\r\n\t\tdispatch({\t\r\n\t\t\ttype: SET_DATA,\r\n\t\t\tpayload: {\r\n\t\t\t\ttype,\r\n\t\t\t\tvalue\r\n\t\t\t}\t\r\n\t\t})\r\n\t\tif(type === 'url') {\r\n\t\t\tfetch(value)\r\n\t\t\t.then((res)=>{\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t\treturn res.json()\r\n\t\t\t})\r\n\t\t\t.then((json)=>{\r\n\t\t\t\tconsole.log(json)\r\n\t\t\t\treturn _.keys(json[0])\r\n\t\t\t})\r\n\t\t\t.then((keys)=>{\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: SET_DATA_KEYS,\r\n\t\t\t\t\tpayload: keys\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(console.error)\r\n\t\t} else {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: SET_DATA_KEYS,\r\n\t\t\t\tpayload: _.keys(value[0])\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\nconst setDataReducer = (state, payload) => {\r\n\tif(state.view) {\r\n\t\tstate.view.finalize()\r\n\t}\r\n\treturn {\r\n\t\t...state,\r\n\t\tview: undefined,\r\n\t\ttabs: _.map(state.tabs, (tab)=> {\r\n\t\t\tif(tab.id !== state.activeTab) return tab\r\n\t\t\treturn {\r\n\t\t\t\t...tab,\r\n\t\t\t\tdata: payload,\r\n\t\t\t\tspec: {\r\n\t\t\t\t\t...tab.spec,\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t[payload.type]: payload.value\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\nconst SET_FOLDERS = '@workspace/FETCH_FOLDERS'\r\nconst setFolders = (folders) => {\r\n\treturn {\r\n\t\ttype: SET_FOLDERS,\r\n\t\tpayload: folders\r\n\t}\r\n}\r\nconst setFoldersReducer = (state, folders) => {\r\n\treturn {\r\n\t\t...state,\r\n\t\tfolders\r\n\t}\r\n}\r\n\r\nexport const WorkspaceReducer = (state = WorkspaceStore, action) => {\r\n\tconsole.log('REDUCE', action.type, action)\r\n\tswitch (action.type) {\r\n\t\tcase SWITCH_TAB:\r\n\t\t\treturn switchTabReducer(state, action.payload)\r\n\t\tcase ADD_TAB:\r\n\t\t\treturn addTabReducer(state, action.payload)\r\n\t\tcase REMOVE_TAB:\r\n\t\t\treturn removeTabReducer(state, action.payload)\r\n\t\tcase CHANGE_SPEC:\r\n\t\t\treturn changeSpecReducer(state, action.payload)\r\n\t\tcase SET_VIEW:\r\n\t\t\treturn setViewReducer(state, action.payload)\r\n\t\tcase SET_DATA:\r\n\t\t\treturn setDataReducer(state, action.payload)\r\n\t\tcase SET_DATA_KEYS:\r\n\t\t\treturn setDataKeysReducer(state, action.payload)\r\n\t\tcase SET_USER:\r\n\t\t\treturn setUserReducer(state, action.payload)\r\n\t\tcase SET_TAB_PROP:\r\n\t\t\treturn setTabPropReducer(state, action.payload)\r\n\t\tcase SET_FOLDERS:\r\n\t\t\treturn setFoldersReducer(state, action.payload)\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nconst bindActionCreators = (actionCreators, dispatch) => {\r\n\treturn _.mapValues(actionCreators, val => (...args) => dispatch(val(...args)))\r\n}\r\n\r\n\r\nconst thunk = ([ store, dispatch ]) => next => action => {\r\n\tif (typeof action === 'function') {\r\n\t\treturn action(dispatch, store);\r\n\t}\r\n\treturn next(action);\r\n};\r\n\r\nconst withMiddlewares = (...middlewares) => ([store, dispatch]) => {\r\n\t\r\n\tconst compose = (...funcs) => {\r\n\t\tif (funcs.length === 0) {\r\n\t\t\treturn arg => arg\r\n\t\t}\r\n\t\r\n\t\tif (funcs.length === 1) {\r\n\t\t\treturn funcs[0]\r\n\t\t}\r\n\t\r\n\t\treturn funcs.reduce((a, b) => (...args) => a(b(...args)))\r\n\t}\r\n\r\n\tconst chain = middlewares.map(middleware => middleware([store, (...args)=>dispatch(...args)]))\r\n  const compositeDispatch = compose(...chain)(dispatch)\r\n\r\n\treturn [store, compositeDispatch]\r\n}\r\n\r\n\r\nexport const useWorkspaceStore = () => {\r\n\tconst [store, dispatch] = withMiddlewares(thunk)(useReducer(WorkspaceReducer, WorkspaceStore))\r\n\treturn {\r\n\t\tstore,\r\n\t\tdispatch,\r\n\t\tget activeTab() {\r\n\t\t\treturn _.find(store.tabs, {\r\n\t\t\t\tid: store.activeTab\r\n\t\t\t}) || _.first(store.tabs)\r\n\t\t},\r\n\t\tgetActiveTab() {\r\n\t\t\treturn _.find(store.tabs, {\r\n\t\t\t\tid: store.activeTab\r\n\t\t\t}) || _.first(store.tabs)\r\n\t\t},\r\n\t\tgetDataKeys() {\r\n\t\t\tconst dataKeys = _.chain(store)\r\n\t\t\t.get('view._runtime.data.source_0.values.value[0]')\r\n\t\t\t.keys()\r\n\t\t\t.value()\r\n\r\n\t\t\treturn dataKeys\r\n\t\t},\r\n\t\t...bindActionCreators({\r\n\t\t\tswitchTab,\r\n\t\t\taddTab,\r\n\t\t\tremoveTab,\r\n\t\t\tchangeSpec,\r\n\t\t\tsetView,\r\n\t\t\tsetData,\r\n\t\t\tsetDataKeys,\r\n\t\t\tsetUser,\r\n\t\t\tsetTabProp,\r\n\t\t\tsetFolders\r\n\t\t}, dispatch)\r\n\t}\r\n}\r\n\r\n\r\n\r\nconst WorkspaceContext = createContext({})\r\n\r\nexport function useWorkspaceContext() {\r\n\treturn useContext(WorkspaceContext)\r\n}\r\n\r\nexport function useDataKeys() {\r\n\tconst store = useWorkspaceContext()\r\n\treturn store.getDataKeys()\r\n}\r\n\r\nexport function useChangeSpec() {\r\n\tconst store = useWorkspaceContext();\r\n\treturn store.changeSpec;\r\n}\r\n\r\nexport default WorkspaceContext","import firebase from 'firebase'\r\n\r\nconst config = {\r\n\tapiKey: \"AIzaSyDQYxDmv_YumWyn_k4KZUet4FBtJjVZCIo\",\r\n\tauthDomain: \"chartmanpoc.firebaseapp.com\",\r\n\tdatabaseURL: \"https://chartmanpoc.firebaseio.com\",\r\n\tprojectId: \"chartmanpoc\",\r\n\tstorageBucket: \"chartmanpoc.appspot.com\",\r\n\tmessagingSenderId: \"209038415542\",\r\n\tappId: \"1:209038415542:web:851c4710b039e1f5\"\r\n}\r\n\r\nconst initialize = () => {\r\n\tif(!firebase.apps.length) {\r\n\t\tfirebase.initializeApp(config)\r\n\t}\r\n}\r\n\r\nconst createBase = (collection, value) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(collection)\r\n\t.add(value)\r\n\t.then(data => data.id)\r\n\t.then(id => ({ ...value, id }))\r\n}\r\n\r\nconst saveBase = (collection, id, value) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(collection)\r\n\t.doc(id)\r\n\t.set(value)\r\n}\r\n\r\n\r\nconst getBase = (collection, id) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(collection)\r\n\t.doc(id)\r\n\t.get()\r\n\t.then(doc=>doc.data() && { ...doc.data(), id: doc.data().id })\r\n}\r\n\r\nconst saveOrCreateBase = (collection, id, value) => {\r\n\treturn getBase(collection, id)\r\n\t.then((data) => {\r\n\t\tif(data) {\r\n\t\t\treturn saveBase(collection, id, value)\r\n\t\t} else {\r\n\t\t\treturn createBase(collection, value)\r\n\t\t}\r\n\t})\r\n}\r\n\r\nconst queryBase = (collection, userId, where) => {\r\n\tinitialize()\r\n\tlet db = firebase\r\n\t.firestore()\r\n\t.collection(collection)\r\n\t.where('user_id', '==', userId)\r\n\r\n\tfor (let key in where) {\r\n\t\tdb.where(key, '==', where[key])\r\n\t}\r\n\r\n\treturn db\r\n\t.get()\r\n\t.then(doc=>doc.data() && { ...doc.data(), id: doc.data().id })\r\n}\r\n\r\nconst snapshotBase = (collection, userId, fn) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(collection)\r\n\t.where('user_id', '==', userId)\r\n\t.onSnapshot((snapshot) => {\r\n\t\tlet res = []\r\n\t\tsnapshot.forEach((doc)=> {\r\n\t\t\tlet data = doc.data()\r\n\t\t\tif(data) res.push({ ...data, id: doc.id })\r\n\t\t})\r\n\t\tfn(res)\r\n\t})\r\n}\r\n\r\nconst saveNewChart = (tab, userId) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection('charts')\r\n\t.add({\r\n\t\t...tab,\r\n\t\tuser_id: userId\r\n\t})\r\n\t.then((data)=>data.id)\r\n}\r\n\r\nconst saveEditedChart = (tab, userId) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection('charts')\r\n\t.doc(tab.uuid)\r\n\t.set({\r\n\t\t...tab,\r\n\t\tuser_id: userId\r\n\t})\r\n}\r\n\r\nconst getChartCollection = (userId = '') => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(\"charts\")\r\n\t.where('user_id', '==', userId)\r\n\t.get()\r\n\t.then((res) => {\r\n\t\tconst data = []\r\n\t\tres.forEach(d=>{\r\n\t\t\tdata.push({\r\n\t\t\t\t...d.data(),\r\n\t\t\t\tuuid: d.id\r\n\t\t\t})\r\n\t\t})\r\n\t\treturn data\r\n\t})\r\n}\r\n\r\nconst getFolders = (userId = '') => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(\"folders\")\r\n\t.where('user_id', '==', userId)\r\n\t.get()\r\n\t.then((res) => {\r\n\t\tconst data = []\r\n\t\tres.forEach(d=>{\r\n\t\t\tdata.push({\r\n\t\t\t\t...d.data(),\r\n\t\t\t\tuuid: d.id\r\n\t\t\t})\r\n\t\t})\r\n\t\treturn data\r\n\t})\r\n}\r\n\r\nconst getUserById = (id) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(\"users\")\r\n\t.doc(id)\r\n\t.get()\r\n\t.then((user)=>{\r\n\t\tlet data = user.data()\r\n\t\tlet id = user.id\r\n\t\tif (!data) throw new Error('User not found')\r\n\t\treturn {\r\n\t\t\t...data,\r\n\t\t\tid\r\n\t\t}\r\n\t})\r\n}\r\n\r\nconst getUserByName = (name) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(\"users\")\r\n\t.where('name', '==', name)\r\n\t.get()\r\n\t.then((users)=>{\r\n\t\tlet data, id\r\n\t\tusers.forEach((user)=>{\r\n\t\t\tdata = user.data()\r\n\t\t\tid = user.id\r\n\t\t})\r\n\t\tif (id) {\r\n\t\t\treturn {\r\n\t\t\t\t...data,\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undefined\r\n\t})\r\n}\r\n\r\nconst createUser = (name) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(\"users\")\r\n\t.add({name})\r\n\t.then(res=>({ name, id: res.id}))\r\n}\r\n\r\nconst createFolder = (userId, folderName) => {\r\n\tinitialize()\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection(\"folders\")\r\n\t.add({name: folderName, user_id: userId})\r\n\t.then(res=>({ name: folderName, user_id: userId, id: res.id}))\r\n}\r\n\r\nconst saveCollection = (userId, collection) => {\r\n\tinitialize()\r\n\tif (!collection.id) {\r\n\t\treturn createFolder(userId, collection.name);\r\n\t}\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection('collection')\r\n\t.doc(collection.id)\r\n\t.set({\r\n\t\t...collection,\r\n\t\tid: collection.id\r\n\t})\r\n}\r\n\r\nconst saveWorkspace = (userId, workspace) => {\r\n\treturn firebase\r\n\t.firestore()\r\n\t.collection('workspace')\r\n\t.doc(userId)\r\n\t.set(workspace)\r\n}\r\n\r\nexport {\r\n\tconfig,\r\n\tinitialize,\r\n\tfirebase,\r\n\tsaveNewChart,\r\n\tsaveEditedChart,\r\n\tgetChartCollection,\r\n\tgetUserById,\r\n\tgetUserByName,\r\n\tcreateUser,\r\n\tsaveCollection,\r\n\tsaveWorkspace,\r\n\tsaveBase,\r\n\tgetBase,\r\n\tcreateBase,\r\n\tsnapshotBase,\r\n\tqueryBase,\r\n\tsaveOrCreateBase\r\n}","import React, {createContext, useContext, useEffect, useState} from 'react'\r\nimport * as firebase from './index'\r\n\r\nconst FirebaseContext = createContext(firebase);\r\n\r\nconst FirebaseProvider = ({children}) => {\r\n\tuseEffect(() => {\r\n\t\tfirebase.initialize()\r\n\t}, [])\r\n\treturn (\r\n\t\t<FirebaseContext.Provider value={firebase}>\r\n\t\t\t{children}\r\n\t\t</FirebaseContext.Provider>\r\n\t)\r\n}\r\n\r\nconst useFirebaseContext = () => {\r\n\treturn useContext(FirebaseContext)\r\n}\r\n\r\nconst useFirebaseSnapshot = (collection, initialValue, userId) => {\r\n\tconst [ value, setValue ] = useState(initialValue)\r\n\tconst { snapshotBase } = useFirebaseContext()\r\n\tuseEffect(()=>{\r\n\t\tsnapshotBase(collection, userId, (res) => {\r\n\t\t\tsetValue(res)\r\n\t\t})\r\n\t}, [collection, userId])\r\n\treturn value\r\n}\r\n\r\nexport {\r\n\tFirebaseContext,\r\n\tuseFirebaseContext,\r\n\tuseFirebaseSnapshot,\r\n\tFirebaseProvider\r\n}","import React, { useEffect, useState, useCallback } from 'react'\r\nimport { Button, Modal, Radio, Input } from 'antd';\r\nimport { useWorkspaceContext } from '../../store/workspace';\r\nimport { useFirebaseContext } from '../../services/firebase/context';\r\n\r\nconst SignInForm = ({error, name, setName}) => {\r\n\treturn (\r\n\t\t<div>\r\n\t\t\tUsername:\r\n\t\t\t<Input value={name} onChange={(e)=>setName(e.target.value)}/>\r\n\t\t\t{error}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nconst SignIn = () => {\r\n\tconst { store : { user = {} }, setUser } = useWorkspaceContext()\r\n\tconst { getUserById, getUserByName, createUser } = useFirebaseContext()\r\n\tconst [ showModal, toggleModal ] = useState(false)\r\n\t\r\n\tconst [name, setName] = useState('')\r\n\tconst [error, setError] = useState('')\r\n\r\n\tuseEffect(() => {\r\n\t\tif(user.id) {\r\n\t\t\tgetUserById(user.id)\r\n\t\t\t.then(setUser)\r\n\t\t\t.catch(()=>toggleModal(true))\r\n\t\t} else {\r\n\t\t\ttoggleModal(true)\r\n\t\t}\r\n\t}, [])\r\n\r\n\tconst signIn = useCallback(\r\n\t\t() => {\r\n\t\t\tgetUserByName(name)\r\n\t\t\t.then(user => {\r\n\t\t\t\tif(!user) {\r\n\t\t\t\t\tsetError('User not found. Sign Up instead?')\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetUser(user)\r\n\t\t\t\t\ttoggleModal(false)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(e => {\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t\tsetError(e.message)\r\n\t\t\t})\r\n\t\t},\r\n\t\t[name, getUserByName, setUser],\r\n\t)\r\n\r\n\tconst signUp = useCallback(\r\n\t\t() => {\r\n\t\t\tif(!name.length) {\r\n\t\t\t\tsetError('Please write your name.')\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tgetUserByName(name)\r\n\t\t\t.then(user => {\r\n\t\t\t\tif(user) {\r\n\t\t\t\t\tsetError('User exist. Please use another name or sign in.')\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn createUser(name).then(user=> {\r\n\t\t\t\t\t\tsetUser(user)\r\n\t\t\t\t\t\ttoggleModal(false)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(e => {\r\n\t\t\t\tsetError(e.message)\r\n\t\t\t})\r\n\t\t},\r\n\t\t[name, getUserByName, setUser, createUser],\r\n\t)\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Modal\r\n\t\t\t\ttitle=\"Sign In / Sign Up\"\r\n\t\t\t\tvisible={showModal}\r\n\t\t\t\tokText={'Sign In'}\r\n\t\t\t\tonOk={signIn}\r\n\t\t\t\tonCancel={signUp}\r\n\t\t\t\tcancelText={'Sign Up'}\r\n\t\t\t>\r\n\t\t\t\t<SignInForm error={error} name={name} setName={setName}/>\r\n\t\t\t</Modal>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default SignIn","export const formItemLayout = {\r\n\tlabelCol: {\r\n\t\txs: { span: 24 },\r\n\t\tsm: { span: 4 },\r\n\t},\r\n\twrapperCol: {\r\n\t\txs: { span: 24 },\r\n\t\tsm: { span: 20 },\r\n\t},\r\n};","import React, { useEffect, useState } from 'react'\r\nimport { Modal, Tabs, Button, Skeleton, Form, Input } from 'antd';\r\nimport { Link } from 'react-router-dom'\r\nimport VegaLite from 'react-vega-lite/lib/VegaLite';\r\nimport { getDefaultSpec } from '../../data/helpers';\r\nimport bar from '../../data/samples/defaults/bar.json';\r\nimport scatter from '../../data/samples/defaults/scatter.json';\r\nimport line from '../../data/samples/defaults/line.json';\r\nimport { useFirebaseContext } from '../../services/firebase/context';\r\nimport { useWorkspaceContext } from '../../store/workspace';\r\nimport { formItemLayout } from '../../helpers/form';\r\nimport { useHistory } from '../../helpers/router';\r\n\r\nconst { TabPane } = Tabs;\r\n\r\nconst DEFAULT_CHARTS = [\r\n\t{\r\n\t\ttitle: 'Simple bar',\r\n\t\tdescription: 'A bar chart encodes quantitative values as the extent of rectangular bars',\r\n\t\tspec: bar\r\n\t},\r\n\t{\r\n\t\ttitle: 'Scatter plot',\r\n\t\tdescription: 'A scatter plot with url data',\r\n\t\tspec: scatter\r\n\t},\r\n\t{\r\n\t\ttitle: 'Line graph',\r\n\t\tdescription: 'A time-series data of stock',\r\n\t\tspec: line\r\n\t},\r\n\r\n]\r\n\r\nconst WelcomeChart = ({\r\n\tchartSelected\r\n}) => {\r\n\tconst { saveBase, getBase } = useFirebaseContext();\r\n\tconst { addTab } = useWorkspaceContext();\r\n\tconst [ charts, setCharts ] = useState([]);\r\n\tuseEffect(() => {\r\n\t\t// saveBase('settings', 'default_charts', {\r\n\t\t// \tname: 'Default Charts',\r\n\t\t// \tvalue: DEFAULT_CHARTS\r\n\t\t// })\r\n\t\tgetBase('settings', 'default_charts')\r\n\t\t.then(result => {\r\n\t\t\tif(result) {\r\n\t\t\t\tsetCharts(result.value);\r\n\t\t\t}\r\n\t\t})\r\n\t}, [])\r\n\tconst onChartSelected = (chart) => {\r\n\t\taddTab(undefined, chart.spec)\r\n\t\tchartSelected()\r\n\t}\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<h6>Select one of the default chart specifications:</h6>\r\n\t\t\t<div className={'row'}>\r\n\t\t\t\t{\r\n\t\t\t\t\t!charts.length &&\r\n\t\t\t\t\t<Skeleton active/>\r\n\t\t\t\t}\r\n\t\t\t\t{\r\n\t\t\t\t\tcharts.map((chart)=>(\r\n\t\t\t\t\t\t<div key={chart.title} className={'col-4 mb-4'}>\r\n\t\t\t\t\t\t\t<div className=\"card\" style={{width: '100%'}}>\r\n\t\t\t\t\t\t\t\t<div className=\"card-img-top\">\r\n\t\t\t\t\t\t\t\t\t<VegaLite\r\n\t\t\t\t\t\t\t\t\t\tspec={chart.spec}\r\n\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\theight: 200, \r\n\t\t\t\t\t\t\t\t\t\t\toverflow: 'hidden',\r\n\t\t\t\t\t\t\t\t\t\t\tbackground: '#ffe',\r\n\t\t\t\t\t\t\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\t\t\t\t\t\t\tjustifyContent: 'center',\r\n\t\t\t\t\t\t\t\t\t\t\talignItems: 'center'\r\n\t\t\t\t\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\t\t\t\trenderer={'canvas'}/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"card-body\">\r\n\t\t\t\t\t\t\t\t\t<h5 className=\"card-title\">{chart.title}</h5>\r\n\t\t\t\t\t\t\t\t\t<p className=\"card-text\">{chart.description}</p>\r\n\t\t\t\t\t\t\t\t\t<Button type=\"primary\" size=\"small\" onClick={()=>onChartSelected(chart)}>+ Start</Button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nconst WelcomeCollection = () => {\r\n\tlet desc = 'A collection is a group of charts you want to manage together in an organized way.'\r\n\tdesc += ' It can be for a research paper, a project you are part of or for your team to share and collaborate.'\r\n\tconst { store } = useWorkspaceContext()\r\n\tconst { createBase } = useFirebaseContext()\r\n\tconst defaultCollection = { name: '', description: '', user_id: store.user.id }\r\n\tconst [ collection, setCollection ] = useState(defaultCollection)\r\n\tconst onCreateCollection = () => {\r\n\t\tcreateBase('collection', collection)\r\n\t}\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<h6>{desc}</h6>\r\n\t\t\t<Form>\r\n\t\t\t\t<Form.Item label={'Name'}>\r\n\t\t\t\t\t<Input value={collection.name} onChange={(v)=>setCollection({...collection, name: v.target.value})}/>\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item label={'Description'}>\r\n\t\t\t\t\t<Input.TextArea value={collection.description} onChange={(v)=>setCollection({...collection, description: v.target.value})}/>\r\n\t\t\t\t</Form.Item>\r\n\t\t\t</Form>\r\n\t\t\t<Button type=\"primary\" onClick={onCreateCollection}>+ Create Collection</Button>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nconst Welcome = ({visible, toggleVisibility}) => {\r\n\tconst { store } = useWorkspaceContext()\r\n\tconst history = useHistory()\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\ttitle={ !!store.user.name ? `Welcome back, ${store.user.name}!` : 'Welcome to Chartman!'}\r\n\t\t\tvisible={visible}\r\n\t\t\twidth={'80%'}\r\n\t\t\tfooter={null}\r\n\t\t\t>\r\n\t\t\t<div style={{height: 500, overflowY: 'auto'}}>\r\n\t\t\t\t<h3>What would you like to do?</h3>\r\n\t\t\t\t<Tabs defaultActiveKey=\"1\">\r\n\t\t\t\t\t<TabPane tab=\"Create Chart\" key=\"1\">\r\n\t\t\t\t\t\t<WelcomeChart chartSelected={()=>{\r\n\t\t\t\t\t\t\ttoggleVisibility(false); \r\n\t\t\t\t\t\t\thistory.push('/workspace')\r\n\t\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t</TabPane>\r\n\t\t\t\t\t<TabPane tab=\"Create Collection\" key=\"2\">\r\n\t\t\t\t\t\t<WelcomeCollection/>\r\n\t\t\t\t\t</TabPane>\r\n\t\t\t\t\t<TabPane tab=\"Explore Showcase\" key=\"3\">\r\n\t\t\t\t\t\t<Link to=\"/showcase\" onClick={()=>toggleVisibility(false)}>Click here to go to the showcase page.</Link>\r\n\t\t\t\t\t</TabPane>\r\n\t\t\t\t</Tabs>\r\n\t\t\t</div>\r\n\t\t</Modal>\r\n\t)\r\n}\r\n\r\nexport default Welcome","import { __RouterContext } from 'react-router';\r\nimport { useContext } from 'react';\r\n\r\nexport const useHistory = () => {\r\n  const context = useContext(__RouterContext);\r\n  return context.history;\r\n};\r\n\r\nexport const useLocation = () => {\r\n  const context = useContext(__RouterContext);\r\n  return context.location;\r\n};\r\n\r\nexport function useMatch() {\r\n  const context = useContext(__RouterContext);\r\n  return context.match;\r\n}\r\n\r\nexport function useParams() {\r\n  const context = useContext(__RouterContext);\r\n  return context.match.params;\r\n}","import _ from 'lodash'\r\nimport React, { useState } from 'react';\r\nimport { Layout as ALayout, Menu } from 'antd';\r\nimport 'antd/dist/antd.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css'\r\nimport '@fortawesome/fontawesome-free/css/all.css'\r\n// import Auth from '../auth';\r\nimport { Link } from 'react-router-dom';\r\nimport SignIn from './sign-in';\r\nimport { useWorkspaceContext } from '../../store/workspace';\r\nimport Welcome from '../welcome';\r\n\r\nconst { Header, Content, Footer } = ALayout;\r\n\r\nconst MENU_ITEMS = [{\r\n\tpath: '/workspace',\r\n\ttitle: 'Workspace'\r\n}, {\r\n\tpath: '/showcase',\r\n\ttitle: 'Showcase'\r\n}, {\r\n\tpath: '/store',\r\n\ttitle: 'Store'\r\n}, {\r\n\tpath: '/docs',\r\n\ttitle: 'Documentation'\r\n}, {\r\n\tpath: '/support',\r\n\ttitle: 'Support'\r\n}]\r\n\r\nconst Layout = ({location, children}) => {\r\n\tconst { store : { user = {}, tabs } } = useWorkspaceContext()\r\n\tconst [visible, toggleVisibility] = useState(!tabs.length)\r\n\treturn (\r\n\t\t<ALayout>\r\n\t\t\t<Welcome visible={visible} toggleVisibility={toggleVisibility}/>\r\n\t\t\t<SignIn/>\r\n\t\t\t<Header className=\"header\">\r\n\t\t\t\t<Menu\r\n\t\t\t\t\ttheme=\"dark\"\r\n\t\t\t\t\tmode=\"horizontal\"\r\n\t\t\t\t\tselectedKeys={[location && location.pathname]}\r\n\t\t\t\t\tstyle={{ lineHeight: '64px' }}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Menu.Item onClick={()=>toggleVisibility(true)}>Welcome {_.capitalize(user.name)}!</Menu.Item>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tMENU_ITEMS.map((item)=> (\r\n\t\t\t\t\t\t\t<Menu.Item key={item.path}><Link to={item.path}>{item.title}</Link></Menu.Item>\r\n\t\t\t\t\t\t))\r\n\t\t\t\t\t}\r\n\t\t\t\t</Menu>\r\n\t\t\t</Header>\r\n\t\t\t<Content>\r\n\t\t\t\t{ children }\r\n\t\t\t</Content>\r\n\t\t\t<Footer style={{ textAlign: 'center' }}>Chartman ©2019 Created by KNSE</Footer>\r\n\t\t</ALayout>\r\n\t)\r\n} \r\n\r\nexport default Layout","/**\r\n * SEO component that queries for data with\r\n *  Gatsby's useStaticQuery React hook\r\n *\r\n * See: https://www.gatsbyjs.org/docs/use-static-query/\r\n */\r\n\r\n// import React from \"react\"\r\n// import PropTypes from \"prop-types\"\r\n// import Helmet from \"react-helmet\"\r\n// import { useStaticQuery, graphql } from \"gatsby\"\r\n\r\n// function SEO({ description, lang, meta, title }) {\r\n//   const { site } = useStaticQuery(\r\n//     graphql`\r\n//       query {\r\n//         site {\r\n//           siteMetadata {\r\n//             title\r\n//             description\r\n//             author\r\n//           }\r\n//         }\r\n//       }\r\n//     `\r\n//   )\r\n\r\n//   const metaDescription = description || site.siteMetadata.description\r\n\r\n//   return (\r\n//     <Helmet\r\n//       htmlAttributes={{\r\n//         lang,\r\n//       }}\r\n//       title={title}\r\n//       titleTemplate={`%s | ${site.siteMetadata.title}`}\r\n//       meta={[\r\n//         {\r\n//           name: `description`,\r\n//           content: metaDescription,\r\n//         },\r\n//         {\r\n//           property: `og:title`,\r\n//           content: title,\r\n//         },\r\n//         {\r\n//           property: `og:description`,\r\n//           content: metaDescription,\r\n//         },\r\n//         {\r\n//           property: `og:type`,\r\n//           content: `website`,\r\n//         },\r\n//         {\r\n//           name: `twitter:card`,\r\n//           content: `summary`,\r\n//         },\r\n//         {\r\n//           name: `twitter:creator`,\r\n//           content: site.siteMetadata.author,\r\n//         },\r\n//         {\r\n//           name: `twitter:title`,\r\n//           content: title,\r\n//         },\r\n//         {\r\n//           name: `twitter:description`,\r\n//           content: metaDescription,\r\n//         },\r\n//       ].concat(meta)}\r\n//     />\r\n//   )\r\n// }\r\n\r\n// SEO.defaultProps = {\r\n//   lang: `en`,\r\n//   meta: [],\r\n//   description: ``,\r\n// }\r\n\r\n// SEO.propTypes = {\r\n//   description: PropTypes.string,\r\n//   lang: PropTypes.string,\r\n//   meta: PropTypes.arrayOf(PropTypes.object),\r\n//   title: PropTypes.string.isRequired,\r\n// }\r\n\r\nexport default function ASEO() {\r\n\treturn null\r\n}\r\n","import React, { memo } from 'react'\r\nimport Highlight, {defaultProps} from 'prism-react-renderer';\r\nimport MonacoEditor from 'react-monaco-editor';\r\n\r\nconst CodeOld = ({children, format, style}) => {\r\n\treturn (\r\n\t\t<div style={style}>\r\n\t\t\t<Highlight {...defaultProps} code={children} language={format}>\r\n\t\t\t\t{({ className, style, tokens, getLineProps, getTokenProps }) => (\r\n\t\t\t\t\t<pre className={className} style={style}>\r\n\t\t\t\t\t\t{tokens.map((line, i) => (\r\n\t\t\t\t\t\t\t<div {...getLineProps({ line, key: i })}>\r\n\t\t\t\t\t\t\t\t{line.map((token, key) => (\r\n\t\t\t\t\t\t\t\t\t<span {...getTokenProps({ token, key })} />\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</pre>\r\n\t\t\t\t)}\r\n\t\t\t</Highlight>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nconst Code = memo(({children, format = 'json', height = 500, style, onChange}) => {\r\n\tconst options = {\r\n\t\tselectOnLineNumbers: true\r\n\t}\r\n\treturn (\r\n\t\t<div style={style}>\r\n\t\t\t<MonacoEditor\r\n        width=\"100%\"\r\n        height={height}\r\n        language={format}\r\n        theme=\"vs-dark\"\r\n        value={children}\r\n        options={options}\r\n\t\t\t\tonChange={onChange}\r\n      />\r\n\t\t</div>\r\n\t)\r\n})\r\n\r\nexport default Code","import _ from 'lodash'\r\nimport React, { useEffect, useState, useCallback, memo } from 'react'\r\nimport { Input, Button, Dropdown, Menu, Modal, Popconfirm, Select, Form } from 'antd'\r\nimport { DATA_SOURCE, useWorkspaceContext, switchTab } from '../../../store/workspace';\r\nimport Code from '../code';\r\nimport { useFirebaseContext, useFirebaseSnapshot } from '../../../services/firebase/context';\r\n\r\nconst InputGroup = Input.Group\r\n\r\nconst DataModal = ({show, onCancel, onOk}) => {\r\n\r\n\tconst {getActiveTab, setData} = useWorkspaceContext()\r\n\tconst tab = getActiveTab()\r\n\t\r\n\tconst [value, setValue] = useState(\"\")\r\n\tconst [format, setFormat] = useState(\"json\")\r\n\tuseEffect(()=>{\r\n\t\tif(tab.data.type === DATA_SOURCE.Url) {\r\n\t\t\tsetFormat(_.last(tab.data.value.split('.')) || 'json')\r\n\t\t\tfetch(tab.data.value)\r\n\t\t\t.then(response=>response.text())\r\n\t\t\t.then(setValue)\r\n\t\t} else {\r\n\t\t\tsetValue(_.isString(tab.data.value) ? tab.data.value : JSON.stringify(tab.data.value, null, 2))\r\n\t\t}\r\n\t}, [tab.data.type, tab.data.value])\r\n\r\n\tconst onDataChanged = useCallback(\r\n\t\t(value) => {\r\n\t\t\tif(tab.data.type === 'values') {\r\n\t\t\t\tsetData('values', value)\r\n\t\t\t}\r\n\t\t},\r\n\t\t[setData, tab]\r\n\t)\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\twidth={600}\r\n\t\t\ttitle=\"Data\"\r\n\t\t\tvisible={show}\r\n\t\t\tonCancel={onCancel}\r\n\t\t\tonOk={onOk}\r\n\t\t>\r\n\t\t\t<Code \r\n\t\t\t\theight={500} \r\n\t\t\t\tformat={format} \r\n\t\t\t\tonChange={onDataChanged}>\r\n\t\t\t\t{value}\r\n\t\t\t</Code>\r\n\t\t</Modal>\r\n\t)\r\n}\r\n\r\nconst DataMenu = ({onSelectionChanged}) => {\r\n\treturn (\r\n\t\t<Menu onClick={(e)=>onSelectionChanged(e.key)}>\r\n\t\t\t{\r\n\t\t\t\t_.keys(DATA_SOURCE).map((source)=>(\r\n\t\t\t\t\t<Menu.Item key={source}>{source}</Menu.Item>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</Menu>\r\n\t);\r\n}\r\n\r\nconst NameModal = ({show, toggleShow}) => {\r\n\tconst { getActiveTab, setTabProp, switchTab, store } = useWorkspaceContext()\r\n\tconst { saveOrCreateBase, saveBase } = useFirebaseContext()\r\n\tconst folders = useFirebaseSnapshot('collection', [], store.user.id)\r\n\tconst tab = getActiveTab()\r\n\r\n\tconst [ error, setError ] = useState()\r\n\tconst [ name, setName ] = useState(tab.name)\r\n\tconst [ folder, setFolder ] = useState({})\r\n\r\n\tconst saveChart = useCallback(\r\n\t\t() => {\r\n\t\t\tsaveOrCreateBase('charts', tab.id, { ...tab, name })\r\n\t\t\t.then((chart) => {\r\n\t\t\t\tconst cObj = {name: chart.name, id: chart.id}\r\n\t\t\t\tconst charts = (folder.charts || []).map((c)=>{\r\n\t\t\t\t\tif(c.id !== chart.id) return c\r\n\t\t\t\t\treturn cObj\r\n\t\t\t\t})\r\n\t\t\t\tif (!_.includes(_.map(charts, 'id'), chart.id)) {\r\n\t\t\t\t\tcharts.push(cObj)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsaveBase('collection', folder.id, {\r\n\t\t\t\t\t...folder,\r\n\t\t\t\t\tcharts\r\n\t\t\t\t})\r\n\t\t\t\tsetTabProp(cObj)\r\n\t\t\t\tswitchTab(cObj.id)\r\n\t\t\t})\r\n\t\t\t.catch((e)=>setError(e.message || e))\r\n\t\t},\r\n\t\t[tab, name, folder, folders]\r\n\t)\r\n\t\r\n\tuseEffect(() => {\r\n\t\tif (tab.id) {\r\n\t\t\t_.each(folders, (f) => {\r\n\t\t\t\tif(_.includes(_.map(f.charts, 'id'), tab.id)) {\r\n\t\t\t\t\tsetFolder(f)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\tsetFolder(_.first(folders) || {})\r\n\t}, [folders, tab])\r\n\r\n\treturn (\r\n\t\t<Modal visible={show} onCancel={()=>toggleShow(false)} onOk={saveChart} okText=\"Save Chart\">\r\n\t\t\t<Form.Item label=\"Chart name\">\r\n\t\t\t\t<Input value={name} onChange={(e)=>setName(e.target.value)}/>\r\n\t\t\t</Form.Item>\r\n\t\t\t<Form.Item label=\"Chart collection\">\r\n\t\t\t\t<Select value={folder.id} onChange={(id)=>setFolder(_.find(folders, {id}))} style={{width: '100%'}}>\r\n\t\t\t\t{\r\n\t\t\t\t\t_.map(folders, (f) => (\r\n\t\t\t\t\t\t<Select.Option key={f.id}>{f.name}</Select.Option>\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\t\t\t</Select>\r\n\t\t\t</Form.Item>\r\n\t\t\t{error}\r\n\t\t</Modal>\r\n\t)\r\n}\r\n\r\nconst DataPicker = ({ tab, onDataChanged }) => {\r\n\t// const [viewData, toggleViewData] = useState(false)\r\n\t// const value = _.isString(tab.data.value) ? tab.data.value : JSON.stringify(tab.data.value, null, 2)\r\n\t// const { getActiveTab } = useWorkspaceContext()\r\n\t// const { saveNewChart } = useFirebaseContext()\r\n\tconst [ showModal, toggleModal ] = useState(false)\r\n\treturn (\r\n\t\t<InputGroup className=\"mb-4\" compact style={{display: 'flex'}}>\r\n\t\t\t{/* <Dropdown overlay={<DataMenu onSelectionChanged={onDataChanged}/>} placement=\"bottomLeft\">\r\n\t\t\t\t<Button type=\"primary\">{`Data source: ${tab.data.type}`}</Button>\r\n\t\t\t</Dropdown>\r\n\t\t\t{\r\n\t\t\t\t{\r\n\t\t\t\t\turl: <Input style={{ flexGrow: 1 }} value={ value} onChange={onDataChanged} />,\r\n\t\t\t\t\tvalues: <Input style={{ flexGrow: 1 }} value={ value } onChange={onDataChanged} />\r\n\t\t\t\t}[tab.data.type]\r\n\t\t\t}\r\n\t\t\t<Button type=\"primary\" onClick={()=>toggleViewData(!viewData)}>View Data</Button> */}\r\n\t\t\t{/* <Popconfirm\r\n\t\t\t\ttitle=\"Confirm save this chart?\"\r\n\t\t\t\tonConfirm={()=>saveNewChart(getActiveTab())}\r\n\t\t\t\tokText=\"Yes\"\r\n\t\t\t\tcancelText=\"No\"\r\n\t\t\t>\r\n\t\t\t\t<Button icon=\"save\" size=\"small\" type=\"primary\">Save Chart</Button>\r\n\t\t\t</Popconfirm> */}\r\n\t\t\t<Button icon=\"save\" size=\"small\" type=\"primary\" onClick={()=>toggleModal(!showModal)}>Save Chart</Button>\r\n\t\t\t<NameModal show={showModal} toggleShow={toggleModal}/>\r\n\t\t\t{/* <DataModal tab={tab} show={viewData} onCancel={()=>toggleViewData(!viewData)} onChanged={onDataChanged}/> */}\r\n\t\t</InputGroup>\r\n\t)\r\n}\r\n\r\nexport default DataPicker","import _ from 'lodash'\r\nimport React from 'react'\r\nimport { findSchema, findEnum } from '../../../data/helpers';\r\nimport { Form, Input, Select, Tabs, Button, Radio } from 'antd';\r\nimport { useWorkspaceContext } from '../../../store/workspace';\r\n\r\nconst PATH = 'FieldDefWithCondition<MarkPropFieldDef,(string|null)>'\r\nconst _SCHEMA = findSchema(PATH)\r\nconst KEYS = _.keys(_SCHEMA)\r\n\r\nconst SAMPLE_VALUE = {\r\n\t\"timeUnit\": \"month\",\r\n\t\"field\": \"date\",\r\n\t\"type\": \"ordinal\",\r\n\t\"axis\": {\"title\": \"Month of the year\"}\r\n}\r\n\r\nconst formItemLayout = {\r\n\tlabelCol: {\r\n\t\txs: { span: 24 },\r\n\t\tsm: { span: 6 },\r\n\t},\r\n\twrapperCol: {\r\n\t\txs: { span: 24 },\r\n\t\tsm: { span: 18 },\r\n\t},\r\n};\r\n\r\nconst EncodingFieldInput = ({spec, path, value, schema, onChange}) => {\r\n\tlet enums = findEnum(schema)\r\n\tconst { changeSpec } = useWorkspaceContext()\r\n\tlet input = <Input value={value} onChange={(e)=>changeSpec(path, _.isNumber(value) ? Number(e.target.value) : e.target.value)}/>\r\n\tif(enums.length) {\r\n\t\tinput = (\r\n\t\t\t<Select value={value} onChange={(v)=>changeSpec(path, v)}>\r\n\t\t\t\t{\r\n\t\t\t\t\tenums.map(e=><Select.Option key={e} value={e}>{_.startCase(e)}</Select.Option>)\r\n\t\t\t\t}\r\n\t\t\t</Select>\r\n\t\t)\r\n\t}\r\n\treturn (\r\n\t\t<Form.Item label={_.startCase(spec)}>\r\n\t\t\t{input}\r\n\t\t</Form.Item>\r\n\t)\r\n}\r\n\r\nconst EncodingField = ({ path, label = 'Label', value = {}, onChange, schema }) => {\r\n\tconst { changeSpec } = useWorkspaceContext()\r\n\r\n\treturn (\r\n\t\t<Form {...formItemLayout}>\r\n\t\t\t<header className={`d-flex justify-content-between`} title={JSON.stringify(schema, null, 2)}>\r\n\t\t\t\t<h4>{_.startCase(label)}</h4>\r\n\t\t\t\t<Button onClick={()=>changeSpec(path, undefined)}>Remove</Button>\r\n\t\t\t</header>\r\n\t\t\t<p>{schema.description}</p>\r\n\t\t\t{/* <Form.Item>\r\n\t\t\t\t<Select onChange={(v)=>changeSpec(`encoding.${v}`, {})}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tschema.anyOf.map((key, i)=>(\r\n\t\t\t\t\t\t\t<Select.Option key={i} value={i}>\r\n\t\t\t\t\t\t\t\t{_.startCase(key.description || key.items.description)}\r\n\t\t\t\t\t\t\t</Select.Option>\r\n\t\t\t\t\t\t))\r\n\t\t\t\t\t}\r\n\t\t\t\t</Select>\r\n\t\t\t</Form.Item>\r\n\t\t\t */\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tschema && schema.anyOf &&\r\n\t\t\t\t<Radio.Group defaultValue=\"a\" buttonStyle=\"solid\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.map(schema.anyOf, (key, i)=>(\r\n\t\t\t\t\t\t\t<Radio.Button key={i} value={i}>\r\n\t\t\t\t\t\t\t\t{_.startCase(key.description || key.items && key.items.description || key.type)}\r\n\t\t\t\t\t\t\t</Radio.Button>\r\n\t\t\t\t\t\t))\r\n\t\t\t\t\t}\r\n\t\t\t\t</Radio.Group>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\t_.keys(value).map((key)=>(\r\n\t\t\t\t\t<EncodingFieldInput \r\n\t\t\t\t\t\tkey={key} \r\n\t\t\t\t\t\tpath={`${path}.${key}`} \r\n\t\t\t\t\t\tspec={key} \r\n\t\t\t\t\t\tvalue={value[key]} \r\n\t\t\t\t\t\tschema={_SCHEMA.properties[key]}\r\n\t\t\t\t\t\tonChange={onChange}/>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</Form>\r\n\t)\r\n\r\n}\r\n\r\n\r\nconst EncodingControl = ({value, onChange}) => {\r\n\tlet {properties, description} = findSchema('Encoding')\r\n\tlet keys = _.keys(value)\r\n\tconst { changeSpec } = useWorkspaceContext()\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t{/* <Form.Item label={'Add Encoding'}>\r\n\t\t\t\t<Select onChange={(v)=>changeSpec(`encoding.${v}`, {})}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.keys(properties).map((key)=>(\r\n\t\t\t\t\t\t\t<Select.Option key={key} disabled={_.includes(keys, key)} value={key}>\r\n\t\t\t\t\t\t\t\t{_.startCase(key)}\r\n\t\t\t\t\t\t\t</Select.Option>\r\n\t\t\t\t\t\t))\r\n\t\t\t\t\t}\r\n\t\t\t\t</Select>\r\n\t\t\t</Form.Item> */}\r\n\t\t\t<Tabs tabPosition={'left'} type={'editable-card'}>\r\n\t\t\t\t{\r\n\t\t\t\t\t_.map(_.keys(properties), (key)=>(\r\n\t\t\t\t\t\t<Tabs.TabPane key={key} tab={_.startCase(key)}>\r\n\t\t\t\t\t\t\t<EncodingField \r\n\t\t\t\t\t\t\t\tpath={`encoding.${key}`} \r\n\t\t\t\t\t\t\t\tkey={key} \r\n\t\t\t\t\t\t\t\tlabel={key} \r\n\t\t\t\t\t\t\t\tvalue={value[key]} \r\n\t\t\t\t\t\t\t\tonChange={onChange}\r\n\t\t\t\t\t\t\t\tschema={properties[key]}/>\r\n\t\t\t\t\t\t</Tabs.TabPane>\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\t\t\t</Tabs>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default EncodingControl","import _ from 'lodash'\r\nimport React, { useCallback } from 'react'\r\nimport { findSchema } from '../../../data/helpers';\r\nimport { Select, Form } from 'antd';\r\n\r\nconst Repeat = ({\r\n\tvalue: { \r\n\t\trow = [], \r\n\t\tcolumn = [] \r\n\t} = {}, \r\n\tconfig: {\r\n\t\toptions = []\r\n\t} = {}, \r\n\tonChange = () => {}\r\n}) => {\r\n\r\n\tconst onRowChange = useCallback(\r\n\t\t(value) => {\r\n\t\t\tonChange({\r\n\t\t\t\tcolumn, row: value\r\n\t\t\t})\r\n\t\t},\r\n\t\t[onChange, column],\r\n\t)\r\n\tconst onColumnChange = useCallback(\r\n\t\t(value) => {\r\n\t\t\tonChange({\r\n\t\t\t\trow, column: value\r\n\t\t\t})\r\n\t\t},\r\n\t\t[onChange, row],\r\n\t)\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<p>\r\n\t\t\t\tRepeat allows multi-variable and complex data to be split into multiple charts represented in column/rows of charts.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tAn example of the usage of repeat is <a href=\"https://www.originlab.com/doc/Origin-Help/Trellis-Plot\">Trellis plot</a>.\r\n\t\t\t</p>\r\n\t\t\t<div>\r\n\t\t\t<Form.Item\r\n\t\t\t\tlabel=\"Row\"\r\n        >\r\n\t\t\t\t<Select\r\n\t\t\t\t\tmode=\"multiple\"\r\n\t\t\t\t\tstyle={{ width: '100%' }}\r\n\t\t\t\t\tplaceholder=\"Please select\"\r\n\t\t\t\t\tdefaultValue={row}\r\n\t\t\t\t\tonChange={onRowChange}\r\n\t\t\t\t>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toptions.map((option)=><Select.Option key={option}>{option}</Select.Option>)\r\n\t\t\t\t\t}\r\n\t\t\t\t</Select>\r\n\t\t\t</Form.Item>\r\n\t\t\t<Form.Item\r\n\t\t\t\tlabel=\"Column\"\r\n        >\r\n\t\t\t\t<Select\r\n\t\t\t\t\tmode=\"multiple\"\r\n\t\t\t\t\tstyle={{ width: '100%' }}\r\n\t\t\t\t\tplaceholder=\"Please select\"\r\n\t\t\t\t\tdefaultValue={column}\r\n\t\t\t\t\tonChange={onColumnChange}\r\n\t\t\t\t>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toptions.map((option)=><Select.Option key={option}>{option}</Select.Option>)\r\n\t\t\t\t\t}\r\n\t\t\t\t</Select>\r\n\t\t\t</Form.Item>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nconst RepeatSchema = {\r\n\ttitle: 'Repeat',\r\n\tid: 'repeat',\r\n\tpath: 'repeat',\r\n\tgenerator: (row = [\"\"], column = [\"\"]) => {\r\n\t\treturn { row, column }\r\n\t},\r\n\tComponent: Repeat,\r\n\tconfig: (store) => {\r\n\t\treturn {\r\n\t\t\toptions: _.chain(store)\r\n\t\t\t\t.get('view._runtime.data.data_0.values.value[0]')\r\n\t\t\t\t.keys()\r\n\t\t\t\t.value()\r\n\t\t}\r\n\t},\r\n\t$schema: findSchema('RepeatRef')\r\n}\r\n\r\nexport default Repeat\r\nexport {\r\n\tRepeatSchema\r\n}","import _ from 'lodash'\r\nimport React, { useCallback, memo, useState, useEffect } from 'react'\r\nimport { findSchema, findEnum } from '../../../data/helpers';\r\nimport { Select, Form, Divider, Dropdown, Button, Menu, Input, Collapse } from 'antd';\r\nimport { useWorkspaceContext } from '../../../store/workspace';\r\nimport { formItemLayout } from '../../../helpers/form';\r\nimport {SketchPicker} from 'react-color'\r\nimport * as vega from 'vega'\r\nimport csvjson from 'csvjson'\r\nconst SCHEMES = [\r\n\t\"accent\",\r\n\t\"category10\",\r\n\t\"category20\",\r\n\t\"category20b\",\r\n\t\"category20c\",\r\n\t\"dark2\",\r\n\t\"paired\",\r\n\t\"pastel1\",\r\n\t\"pastel2\",\r\n\t\"set1\",\r\n\t\"set2\",\r\n\t\"set3\",\r\n\t\"tableau10\",\r\n\t\"tableau20\"\r\n]\r\nconst DropdownMenu = memo(({\r\n\tlabel = '',\r\n\toptions = [],\r\n\tvalue = '',\r\n\tonMenuItemClicked\r\n}) => {\r\n\tconst onItemClicked = useCallback((e)=> {\r\n\t\tonMenuItemClicked && onMenuItemClicked(e.key)\r\n\t}, [onMenuItemClicked])\r\n\tconst schemeMenu = (\r\n\t\t<Menu style={{maxHeight: 200, overflowY: 'auto', boxShadow: '0px -1px 10px lightgrey'}}>\r\n\t\t\t{\r\n\t\t\t\t_.map(options, (key)=>(\r\n\t\t\t\t\t<Menu.Item \r\n\t\t\t\t\t\tkey={key}\r\n\t\t\t\t\t\tonClick={onItemClicked}\r\n\t\t\t\t\t\t>{key}\r\n\t\t\t\t\t</Menu.Item>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</Menu>\r\n\t)\r\n\treturn (\r\n\t\t<Dropdown.Button overlay={schemeMenu} icon={value} size=\"small\">\r\n\t\t\t{label}\r\n\t\t</Dropdown.Button>\r\n\t)\r\n})\r\n\r\nconst LayerEncoding = memo(({\r\n\tlayerIndex = 0,\r\n\tencoding = '',\r\n\tvalue = {}\r\n}) => {\r\n\tconst { changeSpec, activeTab : {dataKeys = []} } = useWorkspaceContext()\r\n\tconst types = findEnum(findSchema('StandardType'))\r\n\tconst aggregates = findEnum(findSchema('AggregateOp'))\r\n\tconst rootPath = `spec.layer[${layerIndex}].encoding.${encoding}`\r\n\treturn (\r\n\t\t<Form.Item label={_.capitalize(encoding)}>\r\n\t\t\t{\r\n\t\t\t\tvalue.field &&\r\n\t\t\t\t<DropdownMenu\r\n\t\t\t\t\tlabel={'Field'}\r\n\t\t\t\t\toptions={dataKeys}\r\n\t\t\t\t\tvalue={value.field}\r\n\t\t\t\t\tonMenuItemClicked={(v)=>changeSpec(`${rootPath}.field`, v)}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tvalue.type &&\r\n\t\t\t\t<DropdownMenu\r\n\t\t\t\t\tlabel={'Type'}\r\n\t\t\t\t\toptions={types}\r\n\t\t\t\t\tvalue={value.type}\r\n\t\t\t\t\tonMenuItemClicked={(v)=>changeSpec(`${rootPath}.type`, v)}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tvalue.aggregate &&\r\n\t\t\t\t<DropdownMenu\r\n\t\t\t\t\tlabel={'Aggregate'}\r\n\t\t\t\t\toptions={aggregates}\r\n\t\t\t\t\tvalue={value.aggregate}\r\n\t\t\t\t\tonMenuItemClicked={(v)=>changeSpec(`${rootPath}.aggregate`, v)}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tvalue.scale && value.scale.scheme &&\r\n\t\t\t\t<DropdownMenu\r\n\t\t\t\t\tlabel={'Scheme'}\r\n\t\t\t\t\toptions={SCHEMES}\r\n\t\t\t\t\tvalue={value.scale.scheme}\r\n\t\t\t\t\tonMenuItemClicked={(v)=>changeSpec(`${rootPath}.scale.scheme`, v)}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tvalue.axis &&\r\n\t\t\t\t<Input \r\n\t\t\t\t\tsize=\"small\" \r\n\t\t\t\t\taddonBefore=\"Axis\" \r\n\t\t\t\t\tvalue={_.get(value, 'axis.title')}\r\n\t\t\t\t\tonChange={(e)=>changeSpec(`${rootPath}.axis.title`, e.target.value)}\r\n\t\t\t\t\taddonAfter={\r\n\t\t\t\t\t\t<Select \r\n\t\t\t\t\t\t\tsize=\"small\" \r\n\t\t\t\t\t\t\tvalue={value.axis.orient} \r\n\t\t\t\t\t\t\tstyle={{ width: 80 }} \r\n\t\t\t\t\t\t\tonChange={(v)=>changeSpec(`${rootPath}.axis.orient`, v)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_.map({\r\n\t\t\t\t\t\t\t\t\ty: ['left', 'right'],\r\n\t\t\t\t\t\t\t\t\tx: ['bottom', 'top']\r\n\t\t\t\t\t\t\t\t}[encoding], (v)=>(\r\n\t\t\t\t\t\t\t\t\t<Select.Option key={v} value={v}>{_.capitalize(v)}</Select.Option>\r\n\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tvalue.legend &&\r\n\t\t\t\t<Input \r\n\t\t\t\t\tsize=\"small\" \r\n\t\t\t\t\taddonBefore=\"Legend\" \r\n\t\t\t\t\tvalue={_.get(value, 'legend.title')}\r\n\t\t\t\t\tonChange={(e)=>changeSpec(`${rootPath}.legend.title`, e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tencoding === 'color' && value.value &&\r\n\t\t\t\t<Input.Group compact>\r\n\t\t\t\t\t<Button size=\"small\">Value</Button>\r\n\t\t\t\t\t<Dropdown overlay={<SketchPicker color={value.value} onChange={(value)=>changeSpec(`${rootPath}.value`, value.hex)}/>}>\r\n\t\t\t\t\t\t<Button size=\"small\" style={{backgroundColor:value.value}}>{value.value}</Button>\r\n\t\t\t\t\t</Dropdown>\r\n\t\t\t\t</Input.Group>\r\n\t\t\t}\r\n\t\t</Form.Item>\r\n\t)\r\n})\r\n\r\nconst LayerMark = memo(({\r\n\tlayerIndex = 0,\r\n\tvalue,\r\n\tonChange\r\n}) => {\r\n\tconst { changeSpec } = useWorkspaceContext()\r\n\tconst schema = findSchema('Mark')\r\n\tconst type = _.isObject(value) ? value.type : value\r\n\treturn (\r\n\t\t<Form.Item label={'Mark'}>\r\n\t\t\t<Select value={type} onChange={(v)=>changeSpec(`spec.layer[${layerIndex}].mark${_.isObject(value)?'.type':''}`,v)} size=\"small\">\r\n\t\t\t\t{\r\n\t\t\t\t\tschema.enum.map((type)=><Select.Option value={type} key={type}>{_.capitalize(type)}</Select.Option>)\r\n\t\t\t\t}\r\n\t\t\t</Select>\r\n\t\t</Form.Item>\r\n\t)\r\n})\r\n\r\nconst LayerItem = memo(({\r\n\tvalue: {\r\n\t\tmark = 'bar',\r\n\t\tencoding = {}\r\n\t} = { },\r\n\tindex = 0\r\n}) => {\r\n\tconst encodings = _.keys(encoding)\r\n\tconst schema = findSchema('Encoding')\r\n\r\n\tconst menu = (\r\n\t\t<Menu>\r\n\t\t\t{\r\n\t\t\t\t_.keys(schema.properties)\r\n\t\t\t\t.map((type) => (\r\n\t\t\t\t\t<Menu.Item key={type} disabled={_.includes(encodings, type)}>{_.startCase(type)}</Menu.Item>\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t</Menu>\r\n\t)\r\n\r\n\treturn (\r\n\t\t<Form {...formItemLayout}>\r\n\t\t\t<LayerMark value={mark} layerIndex={index}/>\r\n\t\t\t{\r\n\t\t\t\t_.map(encodings, (key)=><LayerEncoding layerIndex={index} key={key} encoding={key} value={encoding[key]}/>)\r\n\t\t\t}\r\n\t\t\t<Dropdown overlay={menu} overlayStyle={{maxHeight: 200, overflowY: 'auto', boxShadow: '0px -1px 10px lightgrey'}}>\r\n\t\t\t\t<Button type={'primary'} size=\"small\">+ Add Encoding</Button>\r\n\t\t\t</Dropdown>\r\n\t\t</Form>\r\n\t)\r\n})\r\n\r\nconst Layer = memo(({\r\n\tvalue = [], \r\n\tconfig: {\r\n\t\tmarks = [],\r\n\t\tencodings = []\r\n\t} = {}, \r\n\tonChange = () => {}\r\n}) => {\r\n\tconst { changeSpec, getActiveTab, setDataKeys } = useWorkspaceContext()\r\n\tconst [ activeLayer, setActiveLayer ] = useState(0)\r\n\tconst tab = getActiveTab()\r\n\tconst url = (tab.spec && tab.spec.data.url) || ''\r\n\tconst addLayer = useCallback(\r\n\t\t() => {\r\n\t\t\tconst newLayer = {..._.last(tab.spec.spec.layer)}\r\n\t\t\tnewLayer.mark = newLayer.mark === 'bar' ? 'line' : 'bar'\r\n\t\t\tchangeSpec('spec.layer', [...tab.spec.spec.layer, newLayer])\r\n\t\t\tsetActiveLayer(activeLayer*1 + 1)\r\n\t\t},\r\n\t\t[tab],\r\n\t)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (_.isEmpty(tab.dataKeys) && url) {\r\n\t\t\tfetch(url)\r\n\t\t\t.then(response=>response.text())\r\n\t\t\t.then((text)=> {\r\n\t\t\t\tlet value = text\r\n\t\t\t\ttry {\r\n\t\t\t\t\tvalue = JSON.parse(value)\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tvalue = csvjson.toObject(value)\r\n\t\t\t\t}\r\n\t\t\t\treturn value\r\n\t\t\t})\r\n\t\t\t.then(data => _.isArray(data) ? _.keys(data[0]) : [])\r\n\t\t\t.then(keys => {\r\n\t\t\t\tconsole.log('keys', keys)\r\n\t\t\t\tsetDataKeys(keys)\r\n\t\t\t})\r\n\t\t\t.catch(console.error)\r\n\t\t}\r\n\t}, [url])\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<p>\r\n\t\t\t\tLayer multiple encodings to create composite chart.\r\n\t\t\t</p>\r\n\t\t\t<Collapse accordion bordered={false} activeKey={[String(activeLayer)]} onChange={setActiveLayer}>\r\n\t\t\t\t{\r\n\t\t\t\t\t_.map(tab.spec.spec.layer, (layer, index) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<Collapse.Panel header={`Layer ${index+1} : ${_.capitalize((layer.mark && layer.mark.type) || layer.mark)}`} key={index}>\r\n\t\t\t\t\t\t\t\t<LayerItem value={layer} index={index}/>\r\n\t\t\t\t\t\t\t</Collapse.Panel>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t</Collapse>\r\n\t\t\t<Divider orientation=\"right\"><Button type={'primary'} size=\"small\" onClick={addLayer}>+ Add Layer</Button></Divider>\r\n\t\t</div>\r\n\t)\r\n})\r\n\r\nconst LayerSchema = {\r\n\ttitle: 'Layer',\r\n\tid: 'layer',\r\n\tpath: 'spec.layer',\r\n\tgenerator: (mark = 'bar', encodings = {}) => {\r\n\t\treturn [{\r\n\t\t\tmark,\r\n\t\t\tencodings\r\n\t\t}]\r\n\t},\r\n\tComponent: Layer,\r\n\tconfig: (store) => {\r\n\t\treturn { }\r\n\t},\r\n\t$schema: findSchema('LayerRef')\r\n}\r\n\r\nexport default Layer\r\nexport {\r\n\tLayerSchema\r\n}","import _ from 'lodash'\r\nimport React, { useState, useEffect, useCallback } from 'react'\r\nimport { findSchema } from '../../../data/helpers';\r\nimport { Radio, Divider, Input, Button } from 'antd';\r\nimport { useWorkspaceContext } from '../../../store/workspace';\r\nimport Code from '../code';\r\n\r\nconst URLData = ({defaultUrl, onChange}) => {\r\n\tconst [url, setUrl] = useState(defaultUrl)\r\n\tconst [data, setData] = useState('')\r\n\tconst tryUrl = 'https://vega.github.io/vega-lite/data/cars.json'\r\n\t\r\n\tconst fetchData = useCallback(\r\n\t\t() => {\r\n\t\t\tfetch(url)\r\n\t\t\t.then(response=>response.text())\r\n\t\t\t.then(setData)\r\n\t\t\t.catch((reason)=>setData(reason.message))\r\n\t\t},\r\n\t\t[url]\r\n\t)\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Divider orientation=\"right\">URL</Divider>\r\n\t\t\t<Input.Search\r\n\t\t\t\tsize=\"small\"\r\n\t\t\t\taddonBefore=\"GET\" \r\n\t\t\t\tvalue={url} \r\n\t\t\t\tonChange={e=>setUrl(e.target.value)}\r\n\t\t\t\tonSearch={fetchData}\r\n\t\t\t\tenterButton={'Fetch'}\r\n\t\t\t\t/>\r\n\t\t\t{\r\n\t\t\t\t!defaultUrl &&\r\n\t\t\t\t<p onClick={()=>setUrl(tryUrl)}>\r\n\t\t\t\t\tTry this: &nbsp;{tryUrl}\r\n\t\t\t\t</p>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\t!_.isEmpty(url) &&\r\n\t\t\t\t<Button onClick={()=>onChange(url)} type=\"primary\" size=\"small\">Confirm URL as data</Button>\r\n\t\t\t}\r\n\t\t\t<p></p>\r\n\t\t\t<Code\r\n\t\t\t\theight={500}>\r\n\t\t\t\t{data}\r\n\t\t\t</Code>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nconst ValuesData = ({values, onDataChanged}) => {\r\n\tconst [format, setFormat] = useState('json')\r\n\tuseEffect(() => {\r\n\t\treturn () => {\r\n\t\t\ttry {\r\n\t\t\t\tJSON.parse(values)\r\n\t\t\t\tsetFormat('json')\r\n\t\t\t} catch {\r\n\t\t\t\tsetFormat('csv')\r\n\t\t\t}\r\n\t\t};\r\n\t}, [values])\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Divider orientation=\"right\">Values</Divider>\r\n\t\t\t<Code\r\n\t\t\t\theight={500} \r\n\t\t\t\tformat={format} \r\n\t\t\t\tonChange={onDataChanged}>\r\n\t\t\t\t{(typeof values) === 'string' ? values : JSON.stringify(values, null, 2)}\r\n\t\t\t</Code>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nconst Data = ({\r\n\tvalue = {}, \r\n\tconfig = {}, \r\n\tonChange = () => {}\r\n}) => {\r\n\t\r\n\tconst {getActiveTab, setData} = useWorkspaceContext()\r\n\tconst tab = getActiveTab()\r\n\tconst [type, setType] = useState(tab.data.type)\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<p>Data can be a URL or Inline values of either CSV or JSON</p>\r\n\t\t\t<Radio.Group onChange={(e)=>setType(e.target.value)} value={type}>\r\n        <Radio value={'url'}>URL</Radio>\r\n        <Radio value={'values'}>Values</Radio>\r\n      </Radio.Group>\r\n\t\t\t{\r\n\t\t\t\ttype === 'url' &&\r\n\t\t\t\t<URLData defaultUrl={tab.data.value} onChange={(value)=>setData('url', value)}/>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\ttype === 'values' &&\r\n\t\t\t\t<ValuesData values={tab.data.value} onDataChanged={(value)=>setData('values', value)}/>\r\n\t\t\t}\r\n\t\t</div>\r\n\t)\r\n}\r\nconst DataSchema = {\r\n\ttitle: 'Data',\r\n\tid: 'data',\r\n\tpath: 'data',\r\n\tgenerator: (type, value) => {\r\n\t\treturn {\r\n\t\t\t[type]: value\r\n\t\t}\r\n\t},\r\n\tComponent: Data,\r\n\tconfig: (store) => {\r\n\t\treturn { }\r\n\t},\r\n\t$schema: findSchema('DataSource')\r\n}\r\n\r\nexport default Data\r\nexport {\r\n\tDataSchema\r\n}","import { RepeatSchema } from \"../../../controls/repeat\";\r\nimport { LayerSchema } from \"../../../controls/layer\";\r\nimport { DataSchema } from \"../../../controls/data\";\r\n\r\n\r\nconst Schema = [\r\n\tDataSchema,\r\n\tLayerSchema,\r\n\tRepeatSchema\r\n]\r\n\r\nexport default Schema","import _ from 'lodash'\r\nimport React from 'react'\r\nimport { Tabs, Form, Input, Select } from 'antd';\r\nimport { findSchema } from '../../../../data/helpers';\r\nimport EncodingControl from '../../../controls/encoding-field';\r\nimport Schema from './schema';\r\n\r\nconst Option = Select.Option\r\n\r\nconst controls = {\r\n\t\"mark\": \"bar\",\r\n\t\"encoding\": {\r\n    \"x\": {\r\n      \"timeUnit\": \"month\",\r\n      \"field\": \"date\",\r\n      \"type\": \"ordinal\",\r\n\t\t\t\"axis\": {\"title\": \"Month of the year\"}\r\n    },\r\n    \"y\": {\r\n      \"aggregate\": \"count\",\r\n      \"type\": \"quantitative\"\r\n    },\r\n    \"color\": {\r\n      \"field\": \"weather\",\r\n      \"type\": \"nominal\",\r\n      \"scale\": {\r\n        \"domain\": [\"sun\",\"fog\",\"drizzle\",\"rain\",\"snow\"],\r\n        \"range\": [\"#e7ba52\",\"#c7c7c7\",\"#aec7e8\",\"#1f77b4\",\"#9467bd\"]\r\n      },\r\n      \"legend\": {\"title\": \"Weather type\"}\r\n    }\r\n\t}\r\n}\r\n\r\nconst FieldControl = ({label, value}) => {\r\n\treturn (\r\n\t\t<Form.Item\r\n\t\t\tlabel={_.capitalize(label)}>\r\n\t\t\t<Input\r\n\t\t\t\tplaceholder=\"Select field\"\r\n\t\t\t\tvalue={value.field}\r\n\t\t\t/>\r\n\t\t</Form.Item>\r\n\t)\r\n}\r\n\r\nconst AggregateControl = ({label, value, onChange}) => {\r\n\tconst schema = findSchema('AggregateOp')\r\n\treturn (\r\n\t\t<Form.Item\r\n\t\t\tlabel={_.capitalize(label)}>\r\n\t\t\t<Select value={value.aggregate} onChange={(v)=>onChange('aggregate', v)}>\r\n\t\t\t\t{\r\n\t\t\t\t\t_.map(schema.enum, (opt)=>(\r\n\t\t\t\t\t\t<Option value={opt}>{_.capitalize(opt)}</Option>\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\t\t\t</Select>\r\n\t\t</Form.Item>\r\n\t)\r\n}\r\n\r\n\r\nconst MarkControl = ({value, onChange}) => {\r\n\tconst schema = findSchema('Mark')\r\n\treturn (\r\n\t\t<Form>\r\n\t\t\t<desc>{schema.description}</desc>\r\n\t\t\t<Form.Item label={'Type'}>\r\n\t\t\t\t<Select value={value} onChange={onChange}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tschema.enum.map((type)=><Option value={type} key={type}>{_.capitalize(type)}</Option>)\r\n\t\t\t\t\t}\r\n\t\t\t\t</Select>\r\n\t\t\t</Form.Item>\r\n\t\t</Form>\r\n\t)\r\n}\r\n\r\nconst ControlSelector = ({specKey, value, onChange}) => {\r\n\tswitch(specKey) {\r\n\t\tcase 'encoding':\r\n\t\t\treturn <EncodingControl value={value} onChange={(p, v)=>onChange(`encoding.${p}`, v)}/>\r\n\t\tcase 'mark':\r\n\t\t\treturn <MarkControl value={value} onChange={(v)=>onChange('mark', v)}/>\r\n\t\tdefault:\r\n\t\t\treturn null\r\n\t}\r\n}\r\n\r\nconst ControlGroup = ({tab, onChange, store = {}}) => {\r\n\tconst { spec } = tab\r\n\treturn (\r\n\t\t<Tabs tabPosition={'left'} defaultActiveKey={'layer'}>\r\n\t\t\t{/*\r\n\t\t\t\t_.chain(tab.spec)\r\n\t\t\t\t.toPairs()\r\n\t\t\t\t.map(([key, value]) => (\r\n\t\t\t\t\t<Tabs.TabPane tab={_.capitalize(key)} key={key}>\r\n\t\t\t\t\t\t<ControlSelector \r\n\t\t\t\t\t\t\tspecKey={key} \r\n\t\t\t\t\t\t\tvalue={value} \r\n\t\t\t\t\t\t\tonChange={onChange}/>\r\n\t\t\t\t\t</Tabs.TabPane>\r\n\t\t\t\t))\r\n\t\t\t\t.value()\r\n\t\t\t*/}\r\n\t\t\t{\r\n\t\t\t\t_.chain(Schema)\r\n\t\t\t\t.map((schemaItem) => {\r\n\t\t\t\t\tconst { Component, id, title, path, config } = schemaItem\r\n\t\t\t\t\tconst value = _.get(spec, path)\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Tabs.TabPane tab={title} key={id}>\r\n\t\t\t\t\t\t\t<Component \r\n\t\t\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\t\t\tconfig={config(store)}\r\n\t\t\t\t\t\t\t\tonChange={(value)=>onChange(path, value)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Tabs.TabPane>\r\n\t\t\t\t\t)\r\n\t\t\t\t})\r\n\t\t\t\t.value()\r\n\t\t\t}\r\n\t\t</Tabs>\r\n\t)\r\n}\r\n\r\nexport default ControlGroup","import _ from 'lodash'\r\nimport React, { memo, useCallback } from 'react'\r\nimport VegaLite from 'react-vega-lite'\r\nimport { Tabs } from 'antd';\r\nimport { Handler } from 'vega-tooltip'\r\nimport Code from '../../../controls/code';\r\nimport { useWorkspaceContext } from '../../../../store/workspace';\r\n\r\nconst ExportTab = ({name, children}) => {\r\n\treturn (\r\n\t\t<div className='pl-4' style={{overflow: 'auto', height: '100%'}}>\r\n\t\t\t<h5>{name}</h5>\r\n\t\t\t<div>{children}</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nconst ExportReact = ({spec}) => {\r\n\tconst { data, ...rest } = spec\r\n\treturn (\r\n\t\t<ExportTab name={'React Component'}>\r\n\t\t\t<p>Use the following code as your React component</p>\r\n\t\t\t<Code format={'jsx'}>\r\n\t\t\t\t{\r\n`\r\nimport React from 'react';\r\nimport VegaLite from 'react-vega-lite';\r\n\r\nconst DATA = ${JSON.stringify(data, null, 2)};\r\nconst SPEC = ${JSON.stringify(rest, null, 2)};\r\n\r\nconst MyChart = () => {\r\n  return (\r\n    <VegaLite spec={SPEC} data={DATA}/>\r\n  )\r\n};\r\n\r\nexport default MyChart;\r\n\t\t\t\t\t`\t\r\n\t\t\t\t}\r\n\t\t\t</Code>\r\n\t\t</ExportTab>\r\n\t)\r\n}\r\n\r\nconst ExportJS = ({spec}) => {\r\n\treturn (\r\n\t\t<ExportTab name={'JavaScript'}>\r\n\t\t\t<p><strong>Step 1:</strong> Import this scripts in your HTML head</p>\r\n\t\t\t<Code format=\"html\" height={100}>\r\n\t\t\t\t{\r\n\t\t\t\t\t`\r\n<script src=\"https://cdn.jsdelivr.net/npm/vega@5.3.5\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/vega-lite@3.2.1\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/vega-embed@4.0.0\"></script>\r\n\t\t\t\t\t`\r\n\t\t\t\t}\r\n\t\t\t</Code>\r\n\t\t\t<p><strong>Step 2:</strong> Create a container (ie. <code>div</code>) in your HTML body with a unique ID.</p>\r\n\t\t\t<Code format=\"html\" height={100}>\r\n\t\t\t\t{`<div id=\"containerID\"></div>`}\r\n\t\t\t</Code>\r\n\t\t\t<p><strong>Step 3:</strong> Insert the following script at the end of your HTML body.</p>\r\n\t\t\t<Code format=\"html\">\r\n\t\t\t\t{\r\n\t\t\t\t\t`\r\n<script type=\"text/javascript\">\r\n  var SPEC = ${JSON.stringify(spec, null, 2)};\r\n  vegaEmbed('#containerID', SPEC);\r\n</script>\r\n\t\t\t\t\t`\r\n\t\t\t\t}\r\n\t\t\t</Code>\r\n\t\t</ExportTab>\r\n\t)\r\n}\r\n\r\nconst ExportEmbed = () => {\r\n\tconst { getActiveTab } = useWorkspaceContext()\r\n\treturn (\r\n\t\t<ExportTab name={'Embedded'}>\r\n\t\t\t<p>Insert the following code into your HTML body:</p>\r\n\t\t\t<Code format=\"html\" height={100}>\r\n\t\t\t{\r\n\t\t\t\t`\r\n<iframe class=\"highcharts-iframe\" src=\"/show/${getActiveTab().id}\" style=\"border: 0; width: 100%; height: 500px\"></iframe>\r\n\t\t\t\t`\r\n\t\t\t}\r\n\t\t\t</Code>\r\n\t\t\tResult:\r\n\t\t\t<iframe class=\"highcharts-iframe\" src={`/show/${getActiveTab().id}`} style={{border: 0, width: '100%', height: 500}}></iframe>\r\n\t\t</ExportTab>\r\n\t)\r\n}\r\n\r\nconst ExportAngular = ({spec}) => {\r\n\treturn (\r\n\t\t<ExportTab name={'Angular Component'}>\r\n\t\t\t<p>To be defined</p>\r\n\t\t</ExportTab>\r\n\t)\r\n}\r\n\r\nconst EXPORT_OPTIONS = [{\r\n\tname: 'React',\r\n\ticon: 'fab fa-react',\r\n\tComponent: ExportReact\r\n},{\r\n\tname: 'Angular',\r\n\ticon: 'fab fa-angular',\r\n\tComponent: ExportAngular\r\n},{\r\n\tname: 'JavaScript',\r\n\ticon: 'fab fa-js',\r\n\tComponent: ExportJS\r\n},{\r\n\tname: 'Embedded',\r\n\ticon: 'fas fa-link',\r\n\tComponent: ExportEmbed\r\n}]\r\n\r\n\r\nconst Export = ({spec}) => {\r\n\treturn (\r\n\t\t<Tabs defaultActiveKey={EXPORT_OPTIONS[0].name}>\r\n\t\t\t{\r\n\t\t\t\t_.map(EXPORT_OPTIONS, (option)=>(\r\n\t\t\t\t\t<Tabs.TabPane style={{height: 500, overflow: 'auto'}} key={option.name} tab={<span><i className={option.icon}></i>{`  ${option.name}`}</span>}>\r\n\t\t\t\t\t\t<option.Component spec={spec}/>\r\n\t\t\t\t\t</Tabs.TabPane>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</Tabs>\r\n\t)\r\n}\r\n\r\nconst Chart = memo(({spec, onNewView}) => {\r\n\tconsole.log('chart is called')\r\n\treturn (\r\n\t\t<div style={{boxShadow: '0px -1px 10px lightgrey', marginLeft: 24, boxSizing: 'border-box'}}>\r\n\t\t\t<Tabs tabPosition={'right'} defaultActiveKey={'1'} style={{height: 500}}>\r\n\t\t\t\t<Tabs.TabPane tab={'Chart'} key={'1'}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t!_.isEmpty(spec) &&\r\n\t\t\t\t\t\t<VegaLite spec={spec} data={spec.data} renderer={'svg'} onNewView={onNewView} tooltip={new Handler().call}/>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Tabs.TabPane>\r\n\t\t\t\t<Tabs.TabPane tab={'Vega Spec'} key={'2'} >\r\n\t\t\t\t\t<Code format={'json'} style={{height: 500, overflow: 'auto'}}>{JSON.stringify(spec, null, 2)}</Code>\r\n\t\t\t\t</Tabs.TabPane>\r\n\t\t\t\t<Tabs.TabPane tab={'Share/Export'} key={'3'}>\r\n\t\t\t\t\t<Export spec={spec}/>\r\n\t\t\t\t</Tabs.TabPane>\r\n\t\t\t</Tabs>\r\n\t\t</div>\r\n\t)\r\n})\r\n\r\nexport default Chart","import _ from 'lodash'\r\nimport React, { useCallback, useEffect } from 'react'\r\nimport { Layout, Row, Col, Skeleton } from 'antd';\r\nimport DataPicker from '../../controls/data-picker';\r\nimport ControlGroup from './control-group';\r\nimport Chart from './chart';\r\nimport { useWorkspaceContext } from '../../../store/workspace';\r\nimport { useFirebaseContext } from '../../../services/firebase/context';\r\n\r\n\r\nconst Editor = () => {\r\n\tconst store = useWorkspaceContext()\r\n\tconst tab = store.getActiveTab()\r\n\tconst { getBase } = useFirebaseContext()\r\n\tconst shouldFetch = _.isEmpty(tab.spec) && tab.id\r\n\tuseEffect(() => {\r\n\t\tif (shouldFetch) {\r\n\t\t\tgetBase('charts', tab.id)\r\n\t\t\t.then(({spec, data}) => {\r\n\t\t\t\tstore.changeSpec('', spec)\r\n\t\t\t\tstore.setData(data.type, data.value)\r\n\t\t\t})\r\n\t\t}\r\n\t}, [tab.id])\r\n\tif (shouldFetch) {\r\n\t\treturn <Skeleton active/>\r\n\t}\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<DataPicker tab={tab}/>\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span={12}>\r\n\t\t\t\t\t<ControlGroup tab={tab} onChange={store.changeSpec} store={store.store}/>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col span={12}>\r\n\t\t\t\t\t<Chart spec={tab.spec} view={store.store.view} onNewView={store.setView}/>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Editor","import _ from 'lodash'\r\nimport React, { useCallback, useEffect, useState, memo } from 'react'\r\nimport { useWorkspaceContext } from '../../store/workspace';\r\nimport { Layout, Menu, Icon, Tabs } from 'antd';\r\nimport Editor from './editor';\r\nimport { useFirebaseContext, useFirebaseSnapshot } from '../../services/firebase/context';\r\n\r\nconst { SubMenu } = Menu;\r\nconst { Content, Sider } = Layout;\r\n\r\nconst WorkspaceFolder = memo(({onSelectItem}) => {\r\n\tconst {store: { user = {}}} = useWorkspaceContext()\r\n\tconst folders = useFirebaseSnapshot('collection', [], user.id)\r\n\r\n\treturn (\r\n\t\t<Menu\r\n\t\t\tmode=\"inline\"\r\n\t\t\tstyle={{height: '100%'}}>\r\n\t\t\t{\r\n\t\t\t\t_.map(folders, (folder) => (\r\n\t\t\t\t\t<SubMenu\r\n\t\t\t\t\t\tkey={folder.id}\r\n\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t<span title={folder.description}>\r\n\t\t\t\t\t\t\t\t<Icon type=\"folder\" />\r\n\t\t\t\t\t\t\t\t{`${folder.name} (${_.size(folder.charts)})`}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t!_.isEmpty(folder.charts) && \r\n\t\t\t\t\t\t\t_.map(folder.charts, (chart) => (\r\n\t\t\t\t\t\t\t\t<Menu.Item key={chart.id} onClick={()=>onSelectItem(chart.id, {}, chart.name)}>{chart.name}</Menu.Item>\r\n\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</SubMenu>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</Menu>\r\n\t)\r\n})\r\n\r\n\r\nconst WorkspaceFolderOld = memo(({onSelectItem}) => {\r\n\tconst {getChartCollection} = useFirebaseContext()\r\n\tconst {store: {folders = [], user = {}}, setFolders} = useWorkspaceContext()\r\n\tuseEffect(() => {\r\n\t\tgetChartCollection(user.id)\r\n\t\t.then(charts=>{\r\n\t\t\tsetFolders(charts)\r\n\t\t})\r\n\t}, [user.id])\r\n\treturn (\r\n\t\t<Menu\r\n\t\t\tmode=\"inline\"\r\n\t\t\tstyle={{ height: '100%' }}\r\n\t\t>\r\n\t\t{\r\n\t\t\t_.map(folders, (folder) => {\r\n\t\t\t\tif(folder.children) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<SubMenu\r\n\t\t\t\t\t\t\tkey={folder.uuid || folder.id}\r\n\t\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t<Icon type=\"folder\" />\r\n\t\t\t\t\t\t\t\t\t{folder.name}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_.map(folder.children, (child, i)=>(\r\n\t\t\t\t\t\t\t\t<Menu.Item key={child.uuid || child.id} onClick={()=>onSelectItem(child.uuid || child.id, child.spec, child.name, child.uuid)}>{child.name}</Menu.Item>\r\n\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</SubMenu>\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Menu.Item key={folder.uuid || folder.id} onClick={()=>onSelectItem(folder.uuid||folder.id, folder.spec, folder.name, folder.uuid)}>{folder.name}</Menu.Item>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\t</Menu>\r\n\t)\r\n})\r\n\r\nconst WorkspaceTabs = memo(({tabs, activeKey, onSwitchTab, onAddTab, onRemoveTab}) => {\r\n\t\r\n\tconst onEdit = useCallback(\r\n\t\t(target, action) => {\r\n\t\t\tif(action === 'add') {\r\n\t\t\t\tonAddTab()\r\n\t\t\t}\r\n\t\t\tif(action === 'remove') {\r\n\t\t\t\tonRemoveTab(target)\r\n\t\t\t}\r\n\t\t},\r\n\t\t[onAddTab, onRemoveTab]\r\n\t) \r\n\r\n\treturn (\r\n\t\t<Tabs\r\n\t\t\ttype=\"editable-card\"\r\n\t\t\tactiveKey={activeKey}\r\n\t\t\tonChange={onSwitchTab}\r\n\t\t\tonEdit={onEdit}\r\n\t\t>\r\n\t\t\t{\r\n\t\t\t\ttabs.map((tab)=>(\r\n\t\t\t\t\t<Tabs.TabPane tab={tab.name} key={String(tab.id)}>\r\n\t\t\t\t\t\t{ activeKey === tab.id && <Editor tab={tab}/> }\r\n\t\t\t\t\t</Tabs.TabPane>\r\n\t\t\t\t))\r\n\t\t\t}\r\n\t\t</Tabs>\t\r\n\t)\r\n})\r\n\r\nconst Workspace = memo(() => {\r\n\tconst {\r\n\t\tstore,\r\n\t\tswitchTab,\r\n\t\tremoveTab,\r\n\t\taddTab\r\n\t} = useWorkspaceContext()\r\n\treturn (\r\n\t\t<Layout style={{ padding: '24px 0', background: '#fff' }}>\r\n\t\t\t<Sider width={300} style={{ background: '#fff' }}>\r\n\t\t\t\t<WorkspaceFolder onSelectItem={addTab}/>\r\n\t\t\t</Sider>\r\n\t\t\t<Content style={{ padding: '0 24px', minHeight: 280 }}>\r\n\t\t\t\t<WorkspaceTabs\r\n\t\t\t\t\ttabs={store.tabs}\r\n\t\t\t\t\tactiveKey={store.activeTab}\r\n\t\t\t\t\tonSwitchTab={switchTab}\r\n\t\t\t\t\tonAddTab={addTab}\r\n\t\t\t\t\tonRemoveTab={removeTab}\r\n\t\t\t\t/>\r\n\t\t\t</Content>\r\n\t\t</Layout>\r\n\t)\r\n})\r\n\r\nexport default Workspace","import React from \"react\"\r\n\r\nimport Layout from \"../components/layout\"\r\nimport SEO from \"../components/seo\"\r\nimport Workspace from \"../components/workspace\";\r\nimport Welcome from \"../components/welcome\";\r\n\r\nconst WorkspacePage = (props) => (\r\n  <Layout {...props}>\r\n    <SEO title=\"Workspace\" />\r\n    <Workspace {...props}/>\r\n\t\t{/* <Welcome/> */}\r\n  </Layout>\r\n)\r\n\r\nexport default WorkspacePage\r\n","import _ from 'lodash'\r\nimport React, { useState, useCallback } from 'react'\r\nimport { Layout, Menu, Modal } from 'antd';\r\nimport VegaLite from 'react-vega-lite';\r\n\r\n\r\nimport emojiSpec from '../../data/samples/emoji-bar.json';\r\nimport ganttSpec from '../../data/samples/gantt.json';\r\nimport histoSpec from '../../data/samples/histogram.json';\r\nimport waterSpec from '../../data/samples/waterfall.json';\r\nimport scatrSpec from '../../data/samples/scatter.json';\r\nimport bubblSpec from '../../data/samples/bubble.json';\r\nimport candlSpec from '../../data/samples/candlestick.json';\r\nimport errorSpec from '../../data/samples/errorband.json';\r\nimport decadSpec from '../../data/samples/decade-line.json';\r\nimport trailSpec from '../../data/samples/trail.json';\r\nimport {withRouter} from 'react-router-dom'\r\nimport { useWorkspaceContext } from '../../store/workspace.js';\r\n// import { navigate } from 'gatsby';\r\n\r\nconst SAMPLES = [\r\n\t{\r\n\t\tspec: emojiSpec,\r\n\t\ttitle: 'Emoji',\r\n\t\tcategory: 'bar'\r\n\t},\r\n\t{\r\n\t\tspec: ganttSpec,\r\n\t\ttitle: 'Gantt',\r\n\t\tcategory: 'bar'\r\n\t},\r\n\t{\r\n\t\tspec: histoSpec,\r\n\t\ttitle: 'Histogram',\r\n\t\tcategory: 'bar'\r\n\t},\r\n\t{\r\n\t\tspec: waterSpec,\r\n\t\ttitle: 'Waterfall',\r\n\t\tcategory: 'bar'\r\n\t},\r\n\t{\r\n\t\tspec: bubblSpec,\r\n\t\ttitle: 'Bubble',\r\n\t\tcategory: 'scatter'\r\n\t},\r\n\t{\r\n\t\tspec: scatrSpec,\r\n\t\ttitle: 'Scatter',\r\n\t\tcategory: 'scatter'\r\n\t},\r\n\t{\r\n\t\tspec: candlSpec,\r\n\t\ttitle: 'Candlestick',\r\n\t\tcategory: 'scatter'\r\n\t},\r\n\t{\r\n\t\tspec: errorSpec,\r\n\t\ttitle: 'Error band',\r\n\t\tcategory: 'line'\r\n\t},\r\n\t{\r\n\t\tspec: decadSpec,\r\n\t\ttitle: 'Split line',\r\n\t\tcategory: 'line'\r\n\t},\r\n\t{\r\n\t\tspec: trailSpec,\r\n\t\ttitle: 'Trail',\r\n\t\tcategory: 'line'\r\n\t}\r\n]\r\n\r\nconst ShowcaseModal = withRouter(({item, visible, onCancel, history}) => {\r\n\tconst workspace = useWorkspaceContext()\r\n\tconst onOK = useCallback(\r\n\t\t() => {\r\n\t\t\tworkspace.addTab(undefined, item.spec, item.title)\r\n\t\t\thistory.push('/workspace')\r\n\t\t\t// navigate('/workspace', {state: {item}})\r\n\t\t},\r\n\t\t[item],\r\n\t)\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\ttitle={item.title}\r\n\t\t\tvisible={visible}\r\n\t\t\tonOk={onOK}\r\n\t\t\tokText={'Show Spec'}\r\n\t\t\tonCancel={onCancel}\r\n\t\t\twidth={'90%'}\r\n\t\t>\r\n\t\t\t<VegaLite \r\n\t\t\t\tspec={item.spec}\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tmaxWidth:'100%',\r\n\t\t\t\t\tbackground: '#ffe',\r\n\t\t\t\t\toverflow: 'auto',\r\n\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\tjustifyContent: 'center'\r\n\t\t\t\t}} \r\n\t\t\t\trenderer={'svg'}/>\r\n\t\t</Modal>\r\n\t)\r\n})\r\n\r\nconst ShowcaseItem = ({item}) => {\r\n\tconst [showModal, toggleModal] = useState(false)\r\n\treturn (\r\n\t\t<div className={'col-4 mb-4'}>\r\n\t\t\t<div className=\"card\" style={{width: '100%'}}>\r\n\t\t\t\t<div className=\"card-img-top\">\r\n\t\t\t\t\t<VegaLite \r\n\t\t\t\t\t\tspec={item.spec}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\theight: 200, \r\n\t\t\t\t\t\t\toverflow: 'hidden',\r\n\t\t\t\t\t\t\tbackground: '#ffe',\r\n\t\t\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\t\t\tjustifyContent: 'center',\r\n\t\t\t\t\t\t\talignItems: 'center'\r\n\t\t\t\t\t\t}} \r\n\t\t\t\t\t\trenderer={'canvas'}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"card-body\">\r\n\t\t\t\t\t<h5 className=\"card-title\">{item.title}</h5>\r\n\t\t\t\t\t<p className=\"card-text\">Some description</p>\r\n\t\t\t\t\t<button className=\"btn btn-primary\" onClick={()=>toggleModal(true)}>Preview</button>\r\n\t\t\t\t\t<ShowcaseModal item={item} visible={showModal} onCancel={()=>toggleModal(false)}/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nconst ShowcaseGrid = ({items}) => {\r\n\treturn (\r\n\t\t<div className={'row'}>\r\n\t\t\t{\r\n\t\t\t\t_.map(items, (item)=>(<ShowcaseItem key={item.title} item={item}/>))\r\n\t\t\t}\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nconst Showcase = ({}) => {\r\n\tconst [activeCategory, setCategory] = useState('bar')\r\n\treturn (\r\n\t\t<Layout style={{ padding: '24px 0', background: '#fff', height: '100vh' }}>\r\n\t\t\t<Layout.Sider width={200}>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tmode=\"inline\"\r\n\t\t\t\t\tstyle={{ height: '100%' }}\r\n\t\t\t\t\tdefaultSelectedKeys={[activeCategory]}\r\n\t\t\t\t>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_.uniqBy(SAMPLES, 'category')\r\n\t\t\t\t\t\t.map((item)=>(<Menu.Item key={item.category} onClick={()=>setCategory(item.category)}>{_.startCase(item.category)}</Menu.Item>))\r\n\t\t\t\t\t}\r\n\t\t\t\t</Menu>\r\n\t\t\t</Layout.Sider>\r\n\t\t\t<Layout.Content style={{ padding: '0 24px', minHeight: 280 }}>\r\n\t\t\t\t<ShowcaseGrid items={_.filter(SAMPLES, {category: activeCategory})}/>\r\n\t\t\t</Layout.Content>\r\n\t\t</Layout>\r\n\t)\r\n}\r\n\r\nexport default Showcase","import React from \"react\"\r\n\r\nimport Layout from \"../components/layout\"\r\nimport SEO from \"../components/seo\"\r\nimport Showcase from \"../components/showcase\";\r\n\r\nconst ShowcasePage = (props) => (\r\n  <Layout {...props}>\r\n    <SEO title=\"Showcase\" />\r\n    <Showcase/>\r\n  </Layout>\r\n)\r\n\r\nexport default ShowcasePage\r\n","import React from \"react\"\r\n\r\nimport Layout from \"../components/layout\"\r\nimport SEO from \"../components/seo\"\r\n\r\nconst NotFoundPage = () => (\r\n  <Layout>\r\n    <SEO title=\"404: Not found\" />\r\n    <h1>NOT FOUND</h1>\r\n    <p>You just hit a route that doesn&#39;t exist... the sadness.</p>\r\n  </Layout>\r\n)\r\n\r\nexport default NotFoundPage\r\n","import React, { useState, useEffect } from 'react'\r\nimport VegaLite from 'react-vega-lite';\r\nimport barSpec from '../data/samples/bar.json'\r\nimport { Layout } from 'antd';\r\nimport SEO from '../components/seo.js';\r\nimport { useParams } from '../helpers/router.js';\r\nimport { useFirebaseContext } from '../services/firebase/context.js';\r\n\r\nconst ShowPage = () => {\r\n\tconst {id} = useParams()\r\n\tconst { getBase } = useFirebaseContext()\r\n\tconst [ spec, setSpec ] = useState()\r\n\tuseEffect(() => {\r\n\t\tgetBase('charts', id)\r\n\t\t.then((chart)=>chart && setSpec(chart.spec))\r\n\t}, [id])\r\n  return (\r\n\t\t<Layout>\r\n\t\t\t{\r\n\t\t\t\tspec &&\r\n\t\t\t\t<VegaLite spec={spec} data={spec.data}/>\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\t!spec && <p>Chart must be saved before embed.</p>\r\n\t\t\t}\r\n\t\t</Layout>\r\n\t)\r\n}\r\n\r\nexport default ShowPage","import React from 'react';\nimport './App.css';\nimport { BrowserRouter as Router, Route, Switch, Redirect } from \"react-router-dom\";\nimport WorkspacePage from './pages/workspace';\nimport ShowcasePage from './pages/showcase';\nimport NotFoundPage from './pages/404';\nimport 'antd/dist/antd.css';\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport '@fortawesome/fontawesome-free/css/all.css'\nimport WorkspaceContext, { useWorkspaceStore } from './store/workspace';\nimport { FirebaseProvider } from './services/firebase/context';\nimport ShowPage from './pages/show';\n\nfunction App() {\n  return (\n    <Router>\n\t\t\t<FirebaseProvider>\n\t\t\t\t<WorkspaceContext.Provider value={useWorkspaceStore()}>\n\t\t\t\t\t<div className=\"App\">\n\t\t\t\t\t\t<Switch>\n\t\t\t\t\t\t\t<Route path=\"/\" exact render={()=><Redirect to={'/workspace/'}/>} />\n\t\t\t\t\t\t\t<Route path=\"/workspace/\" exact component={WorkspacePage} />\n\t\t\t\t\t\t\t<Route path=\"/showcase/\" component={ShowcasePage} />\n\t\t\t\t\t\t\t<Route path=\"/show/:id\" component={ShowPage} />\n\t\t\t\t\t\t\t<Route component={NotFoundPage} />\n\t\t\t\t\t\t</Switch>\n\t\t\t\t\t</div>\n\t\t\t\t</WorkspaceContext.Provider>\n\t\t\t</FirebaseProvider>\n    </Router>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}